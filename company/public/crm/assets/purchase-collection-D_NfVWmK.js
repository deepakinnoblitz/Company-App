import{f as i,H as d}from"./index-Co7v2xsC.js";import{h}from"./api-error-handler-CV6pRVHb.js";async function _(e){const t=[],o=[];e.filterValues&&Object.entries(e.filterValues).forEach(([l,s])=>{s&&s!=="all"&&(l==="vendor_name"?t.push(["Purchase Collection","vendor","=",s]):t.push(["Purchase Collection",l,"=",s]))}),e.search&&(o.push(["Purchase Collection","name","like",`%${e.search}%`]),o.push(["Purchase Collection","purchase","like",`%${e.search}%`]),o.push(["Purchase Collection","vendor_name","like",`%${e.search}%`]));let n="creation desc";if(e.sort_by){const[l,s]=e.sort_by.split("_").reduce((r,c)=>(c==="asc"||c==="desc"?r[1]=c:r[0]=r[0]?`${r[0]}_${c}`:c,r),["","desc"]);n=`${l} ${s}`}const a=new URLSearchParams({doctype:"Purchase Collection",fields:JSON.stringify(["name","purchase","vendor","vendor_name","collection_date","amount_collected","amount_pending","amount_to_pay","mode_of_payment","creation"]),filters:JSON.stringify(t),or_filters:JSON.stringify(o),limit_start:String((e.page-1)*e.page_size),limit_page_length:String(e.page_size),order_by:n}),[u,f]=await Promise.all([i(`/api/method/frappe.client.get_list?${a.toString()}`),i(`/api/method/frappe.client.get_count?doctype=Purchase Collection&filters=${encodeURIComponent(JSON.stringify(t))}&or_filters=${encodeURIComponent(JSON.stringify(o))}`)]);if(!u.ok)throw new Error("Failed to fetch purchase collections");const p=await u.json(),g=await f.json();return{data:p.message||[],total:g.message||0}}async function w(e){const t=await d(),o=await i("/api/method/frappe.client.insert",{method:"POST",headers:t,body:JSON.stringify({doc:{doctype:"Purchase Collection",...e}})}),n=await o.json();if(!o.ok)throw new Error(h(n,"Failed to create purchase collection"));return n.message}async function P(e,t){const o=await d(),n=await i("/api/method/frappe.client.set_value",{method:"POST",headers:o,body:JSON.stringify({doctype:"Purchase Collection",name:e,fieldname:t})}),a=await n.json();if(!n.ok)throw new Error(h(a,"Failed to update purchase collection"));return a.message}async function C(e){const t=await d(),o=await i("/api/method/frappe.client.delete",{method:"POST",headers:t,body:JSON.stringify({doctype:"Purchase Collection",name:e})}),n=await o.json();if(!o.ok)throw new Error(h(n,"Failed to delete purchase collection"));return n.message}async function S(e){const t=await i(`/api/method/frappe.client.get?doctype=Purchase Collection&name=${encodeURIComponent(e)}`);if(!t.ok)throw new Error("Failed to fetch purchase collection details");return(await t.json()).message}export{w as c,C as d,_ as f,S as g,P as u};
