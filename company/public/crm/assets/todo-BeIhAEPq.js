import{h as w,r as i,j as t,p as h,I as j,B as F,w as I}from"./index-Co7v2xsC.js";import{C as E}from"./config-global-BX9xwJzv.js";import{F as O,i as W,a as z,b as G}from"./index-DcBM0rMB.js";import{i as M}from"./index-BLaIkoYk.js";import{D as $,C as N}from"./Card-CDV3jV6O.js";import{f as R,T as B,u as H,d as A}from"./todo-dialog-gzK4SeKR.js";import{C as V}from"./confirm-dialog--19ddTk_.js";import{C as P}from"./CardHeader-CmhzWAj1.js";import{S as U}from"./Snackbar-BVA3LOhi.js";import"./dayjs.min-C2542nnJ.js";import"./api-error-handler-CV6pRVHb.js";import"./utils-CQVN1UoU.js";import"./DialogContent-DtP-sWqR.js";import"./DialogTitle-C3eBZids.js";import"./AdapterDayjs-BPhbSeWE.js";import"./index-Chjiymov.js";import"./useThemeProps-BDg4jra0.js";import"./useFormControl-Cqn8lfES.js";import"./Popper-DDlcgFVJ.js";import"./Select-B1EkSlUY.js";import"./visuallyHidden-Dan1xhjv.js";import"./TextField-BmVWmDzd.js";import"./DialogActions-h_2rRG3x.js";import"./Chip-Rg4Dn3a5.js";import"./Grid-BdmJn5bP.js";import"./DatePicker-BMZY9CMK.js";function q(){const o=w(),[u,x]=i.useState([]),[c,d]=i.useState(null),[g,s]=i.useState(!1),[y,f]=i.useState({open:!1,id:null}),[p,l]=i.useState({open:!1,message:"",severity:"success"}),n=i.useCallback(async(e,a)=>{try{const r=e==null?void 0:e.toISOString().split("T")[0],m=a==null?void 0:a.toISOString().split("T")[0],T=await R(r,m);x(T)}catch(r){console.error("Failed to load todos:",r)}},[]);i.useEffect(()=>{n()},[n]);const b=e=>{n(e.start,e.end)},v=e=>{const a=e.event.id,r=u.find(m=>m.name===a);r&&(d(r),s(!0))},D=()=>{d(null),s(!0)},C=async e=>{const{event:a}=e;try{await H(a.id,{date:a.start.toISOString().split("T")[0]}),n()}catch(r){console.error("Failed to update todo position:",r),l({open:!0,message:r.message||"Failed to update todo position",severity:"error"}),e.revert()}},k=async()=>{if(c)try{await A(c.name),s(!1),f({open:!1,id:null}),n(),l({open:!0,message:"ToDo deleted successfully",severity:"success"})}catch(e){console.error("Failed to delete todo:",e),l({open:!0,message:e.message||"Failed to delete todo",severity:"error"})}},S=u.map(e=>({id:e.name,title:e.description||"Untitled Task",start:e.date,allDay:!0,color:e.color||(e.status==="Closed"?o.palette.success.main:e.priority==="High"?o.palette.error.main:o.palette.primary.main)}));return t.jsxs($,{children:[t.jsxs(N,{sx:{display:"flex",flexDirection:"column"},children:[t.jsx(P,{title:"ToDo Calendar",subheader:"Manage your tasks and to-dos",action:t.jsx(h,{variant:"contained",onClick:D,startIcon:t.jsx(j,{icon:"mingcute:add-line"}),children:"New Task"}),sx:{mb:1}}),t.jsx(F,{sx:{p:3,pt:0,"& .fc":{"--fc-border-color":o.palette.divider,"--fc-daygrid-event-dot-width":"8px","--fc-list-event-dot-width":"10px","--fc-today-bg-color":o.palette.primary.lighter},"& .fc .fc-toolbar":{mb:3,gap:1.5,flexDirection:{xs:"column",md:"row"},"& .fc-toolbar-title":{fontSize:"1.25rem",fontWeight:700}},"& .fc .fc-button":{border:"none",py:"8px",px:"12px",borderRadius:"8px",fontSize:"0.875rem",fontWeight:600,textTransform:"capitalize",backgroundColor:o.palette.background.neutral,color:o.palette.text.primary,transition:o.transitions.create(["background-color","color","box-shadow"]),"&:hover":{backgroundColor:o.palette.action.hover},"&:focus":{boxShadow:"none"},"&.fc-button-active":{backgroundColor:o.palette.primary.main,color:o.palette.common.white,"&:hover":{backgroundColor:o.palette.primary.dark}}},"& .fc .fc-col-header-cell":{py:1.5,backgroundColor:o.palette.primary.main,color:o.palette.common.white,"& .fc-col-header-cell-cushion":{textDecoration:"none",fontSize:"0.875rem",fontWeight:700}},"& .fc-view-harness":{borderRadius:"12px",overflow:"hidden",border:`1px solid ${o.palette.divider}`}},children:t.jsx(O,{plugins:[W,M,z,G],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:"dayGridMonth",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:3,weekends:!0,events:S,datesSet:b,eventClick:v,eventDrop:C,select:e=>{d(null),s(!0)},height:"auto",eventDisplay:"block"})})]}),t.jsx(B,{open:g,onClose:()=>s(!1),selectedTodo:c,onSuccess:n}),t.jsx(V,{open:y.open,onClose:()=>f({open:!1,id:null}),title:"Confirm Delete",content:"Are you sure you want to delete this task?",action:t.jsx(h,{onClick:k,color:"error",variant:"contained",sx:{borderRadius:1.5,minWidth:100},children:"Delete"})}),t.jsx(U,{open:p.open,autoHideDuration:6e3,onClose:()=>l(e=>({...e,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},children:t.jsx(I,{onClose:()=>l(e=>({...e,open:!1})),severity:p.severity,sx:{width:"100%"},children:p.message})})]})}function ye(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:`ToDo - ${E.appName}`}),t.jsx(q,{})]})}export{ye as default};
