import{f as n,H as r}from"./index-Co7v2xsC.js";import{h as a}from"./api-error-handler-CV6pRVHb.js";async function g(e){const o=[],t=[];e.filters&&(e.filters.invoice&&o.push(["Invoice Collection","invoice","=",e.filters.invoice]),e.filters.customer&&e.filters.customer!=="all"&&o.push(["Invoice Collection","customer","=",e.filters.customer]),e.filters.collection_date&&o.push(["Invoice Collection","collection_date","=",e.filters.collection_date]),e.filters.mode_of_payment&&e.filters.mode_of_payment!=="all"&&o.push(["Invoice Collection","mode_of_payment","=",e.filters.mode_of_payment])),e.search&&(t.push(["Invoice Collection","name","like",`%${e.search}%`]),t.push(["Invoice Collection","invoice","like",`%${e.search}%`]),t.push(["Invoice Collection","customer_name","like",`%${e.search}%`]));let i="creation desc";if(e.sort_by){const[h,m]=e.sort_by.split("_").reduce((c,l)=>(l==="asc"||l==="desc"?c[1]=l:c[0]=c[0]?`${c[0]}_${l}`:l,c),["","desc"]);i=`${h} ${m}`}const s=new URLSearchParams({doctype:"Invoice Collection",fields:JSON.stringify(["name","invoice","customer","customer_name","company_name","collection_date","amount_collected","mode_of_payment","amount_pending","amount_to_pay","creation"]),filters:JSON.stringify(o),or_filters:JSON.stringify(t),limit_start:String((e.page-1)*e.page_size),limit_page_length:String(e.page_size),order_by:i}),[f,d]=await Promise.all([n(`/api/method/frappe.client.get_list?${s.toString()}`),n(`/api/method/frappe.client.get_count?doctype=Invoice Collection&filters=${encodeURIComponent(JSON.stringify(o))}&or_filters=${encodeURIComponent(JSON.stringify(t))}`)]);if(!f.ok)throw new Error("Failed to fetch invoice collections");const u=await f.json(),_=await d.json();return{data:u.message||[],total:_.message||0}}async function v(e){const o=await r(),t=await n("/api/method/frappe.client.insert",{method:"POST",headers:o,body:JSON.stringify({doc:{doctype:"Invoice Collection",...e}})}),i=await t.json();if(!t.ok)throw new Error(a(i,"Failed to create invoice collection"));return i.message}async function w(e,o){const t=await r(),i=await n("/api/method/frappe.client.set_value",{method:"POST",headers:t,body:JSON.stringify({doctype:"Invoice Collection",name:e,fieldname:o})}),s=await i.json();if(!i.ok)throw new Error(a(s,"Failed to update invoice collection"));return s.message}async function C(e){const o=await r(),t=await n("/api/method/frappe.client.delete",{method:"POST",headers:o,body:JSON.stringify({doctype:"Invoice Collection",name:e})}),i=await t.json();if(!t.ok)throw new Error(a(i,"Failed to delete invoice collection"));return i.message}async function I(e){const o=await n(`/api/method/frappe.client.get?doctype=Invoice Collection&name=${encodeURIComponent(e)}`);if(!o.ok)throw new Error("Failed to fetch invoice collection details");return(await o.json()).message}export{v as c,C as d,g as f,I as g,w as u};
