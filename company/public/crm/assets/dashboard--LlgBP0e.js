const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-apexcharts.min-Tw9Uc0mB.js","assets/index-Co7v2xsC.js","assets/index-CLEJBD1W.css","assets/index-Chjiymov.js"])))=>i.map(i=>d[i]);
import{f as k,g as be,a as _e,r as T,u as ve,j as e,s as F,c as we,b as Se,m as Te,d as x,e as xe,k as ne,h as U,S as A,B as u,I as $,T as p,i as q,l as z,U as re,_ as Ce,n as ke,o as We,E as Re,D as ze}from"./index-Co7v2xsC.js";import{C as De}from"./config-global-BX9xwJzv.js";import{C,D as K}from"./Card-CDV3jV6O.js";import{h as W}from"./api-error-handler-CV6pRVHb.js";import{F as $e,i as Fe,a as Ie,b as Ae}from"./index-DcBM0rMB.js";import{C as R}from"./CardHeader-CmhzWAj1.js";import{f as Ee}from"./format-time-9uMX-KY9.js";import{S as J}from"./Stack-GQIY7Xk9.js";import{f as ie,a as Le,b as Me,c as X}from"./format-number-DSNgsWBE.js";import{T as L,a as M,b as N,c as j,d as l,e as O}from"./TableRow-DqeBPnxy.js";import{G as c}from"./Grid-BdmJn5bP.js";import{L as me}from"./label-BpZ9ieER.js";import"./styles-wAmuuHpw.js";import"./dayjs.min-C2542nnJ.js";function Ne(t){return String(t).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Oe(t){return parseFloat(t)}async function pe(){try{const t=await k("/api/method/company.company.frontend_api.get_dashboard_stats");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch dashboard stats"))}return(await t.json()).message}catch(t){return console.error("Failed to fetch dashboard stats:",t),{leads:0,contacts:0,deals:0,accounts:0,recent_leads:0,total_deal_value:0,leads_by_status:[],deals_by_stage:[],charts:{categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],leads:[0,0,0,0,0,0,0],contacts:[0,0,0,0,0,0,0],deals:[0,0,0,0,0,0,0],accounts:[0,0,0,0,0,0,0]}}}}async function ue(){try{const t=await k("/api/method/company.company.frontend_api.get_today_activities");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch today activities"))}return(await t.json()).message}catch(t){return console.error("Failed to fetch today activities:",t),{calls:[],meetings:[]}}}async function Ue(){const t=await k("/api/method/company.company.api.get_recent_announcements");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch announcements"))}return(await t.json()).message||[]}async function He(){const t=await k("/api/method/company.company.api.get_upcoming_and_expired_renewals");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch upcoming renewals"))}return(await t.json()).message||[]}async function de(t,s){let n="/api/method/company.company.api.get_month_holidays";const r=new URLSearchParams;t&&r.append("month",t.toString()),s&&r.append("year",s.toString()),r.toString()&&(n+=`?${r.toString()}`);const i=await k(n);if(!i.ok){const o=await i.json();throw new Error(W(o,"Failed to fetch month holidays"))}return(await i.json()).message||[]}async function Be(){const t=await k("/api/method/company.company.api.get_today_birthdays");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch birthdays"))}return(await t.json()).message||[]}async function Ve(){const t=await k("/api/method/company.company.api.get_today_leave_employees");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch today leave employees"))}return(await t.json()).message||[]}async function Ge(t="today"){const s=await k(`/api/method/company.company.api.get_attendance_stats?range=${t}`);if(!s.ok){const r=await s.json();throw new Error(W(r,"Failed to fetch attendance stats"))}return(await s.json()).message}async function Xe(){const t=await k(`/api/method/frappe.client.get_count?doctype=Employee&filters=${encodeURIComponent(JSON.stringify([]))}`);if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch employee count"))}return(await t.json()).message||0}async function qe(){const s=await k(`/api/method/frappe.client.get_count?doctype=Leave Application&filters=${encodeURIComponent(JSON.stringify([["Leave Application","workflow_state","=","Pending"]]))}`);if(!s.ok){const r=await s.json();throw new Error(W(r,"Failed to fetch pending leave count"))}return(await s.json()).message||0}async function ge(){try{const t=await k("/api/method/company.company.frontend_api.get_sales_dashboard_data");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch sales dashboard data"))}return(await t.json()).message}catch(t){return console.error("Failed to fetch sales dashboard data:",t),{total_sales:0,total_qty_sold:0,total_orders:0,aov:0,gross_sales:0,net_sales:0,total_discounts:0,mtd_sales:0,ytd_sales:0,pipeline_value:0,top_customers_by_revenue:[],most_repeated_customers:[],overdue_orders:[],pending_orders_count:0,sales_trend:{categories:[],series:[]},discount_trend:{categories:[],series:[]},conversion_rate:0}}}async function Ye(){try{const t=await k("/api/method/company.company.frontend_api.get_financial_totals");if(!t.ok){const n=await t.json();throw new Error(W(n,"Failed to fetch financial totals"))}return(await t.json()).message}catch(t){return console.error("Failed to fetch financial totals:",t),{invoices:{total:0,count:0,chart:[0,0,0,0,0,0,0]},estimations:{total:0,count:0,chart:[0,0,0,0,0,0,0]},purchases:{total:0,count:0,chart:[0,0,0,0,0,0,0]},expenses:{total:0,count:0,chart:[0,0,0,0,0,0,0]},categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]}}}function Je(t){return be("MuiSkeleton",t)}_e("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const Ke=t=>{const{classes:s,variant:n,animation:r,hasChildren:i,width:a,height:o}=t;return Se({root:["root",n,r,i&&"withChildren",i&&!a&&"fitContent",i&&!o&&"heightAuto"]},Je,s)},ee=ne`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,te=ne`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,Qe=typeof ee!="string"?xe`
        animation: ${ee} 2s ease-in-out 0.5s infinite;
      `:null,Ze=typeof te!="string"?xe`
        &::after {
          animation: ${te} 2s linear 0.5s infinite;
        }
      `:null,Pe=F("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:n}=t;return[s.root,s[n.variant],n.animation!==!1&&s[n.animation],n.hasChildren&&s.withChildren,n.hasChildren&&!n.width&&s.fitContent,n.hasChildren&&!n.height&&s.heightAuto]}})(Te(({theme:t})=>{const s=Ne(t.shape.borderRadius)||"px",n=Oe(t.shape.borderRadius);return{display:"block",backgroundColor:t.vars?t.vars.palette.Skeleton.bg:x(t.palette.text.primary,t.palette.mode==="light"?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${n}${s}/${Math.round(n/.6*10)/10}${s}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:({ownerState:r})=>r.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:r})=>r.hasChildren&&!r.width,style:{maxWidth:"fit-content"}},{props:({ownerState:r})=>r.hasChildren&&!r.height,style:{height:"auto"}},{props:{animation:"pulse"},style:Qe||{animation:`${ee} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(
                90deg,
                transparent,
                ${(t.vars||t).palette.action.hover},
                transparent
              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:Ze||{"&::after":{animation:`${te} 2s linear 0.5s infinite`}}}]}})),et=T.forwardRef(function(s,n){const r=ve({props:s,name:"MuiSkeleton"}),{animation:i="pulse",className:a,component:o="span",height:h,style:m,variant:d="text",width:g,...b}=r,y={...r,animation:i,component:o,variant:d,hasChildren:!!b.children},v=Ke(y);return e.jsx(Pe,{as:o,ref:n,className:we(v.root,a),ownerState:y,...b,style:{width:g,height:h,...m}})});function tt({title:t,subheader:s,events:n,onDateChange:r,...i}){const a=U();return e.jsxs(C,{...i,sx:{background:x(a.palette.background.paper,.8),backdropFilter:"blur(10px)",border:`1px solid ${x(a.palette.grey[500],.12)}`,...i.sx},children:[e.jsx(R,{title:t,subheader:s,sx:{mb:2,"& .MuiTypography-root":{fontWeight:"bold"}}}),e.jsx(A,{sx:{maxHeight:600},children:e.jsx(u,{sx:{p:2,"& .fc":{"--fc-border-color":x(a.palette.grey[500],.08),"--fc-today-bg-color":x(a.palette.primary.main,.04),"--fc-page-bg-color":"transparent","--fc-neutral-bg-color":x(a.palette.grey[500],.02),"--fc-list-event-hover-bg-color":x(a.palette.primary.lighter,.4),fontFamily:a.typography.fontFamily},"& .fc .fc-toolbar-title":{fontSize:"1.25rem",fontWeight:800,color:a.palette.text.primary,letterSpacing:-.5},"& .fc .fc-button":{bgcolor:"background.neutral",border:"none",color:a.palette.text.secondary,fontWeight:700,textTransform:"capitalize",borderRadius:"10px",px:1.5,transition:a.transitions.duration.shorter,"&:hover":{bgcolor:x(a.palette.primary.main,.08),color:a.palette.primary.main},"&:disabled":{bgcolor:x(a.palette.grey[500],.05),color:a.palette.text.disabled}},"& .fc .fc-button-primary:not(:disabled).fc-button-active":{bgcolor:x(a.palette.primary.main,.1),color:a.palette.primary.main,fontWeight:800},"& .fc .fc-daygrid-day-number":{color:a.palette.text.secondary,fontWeight:600,fontSize:"0.8rem",p:1.5},"& .fc .fc-col-header-cell-cushion":{color:a.palette.text.disabled,fontWeight:700,textTransform:"uppercase",fontSize:"0.65rem",letterSpacing:1.2,py:2},"& .fc .fc-scrollgrid":{border:"none"},"& .fc .fc-daygrid-day":{transition:a.transitions.duration.shorter,"&:hover":{bgcolor:x(a.palette.primary.main,.02)}},"& .fc .fc-event":{borderRadius:"8px",border:"none",padding:"4px 8px",fontSize:"0.7rem",fontWeight:700,boxShadow:`0 4px 12px 0 ${x(a.palette.primary.main,.2)}`,cursor:"pointer",transition:a.transitions.duration.shorter,background:`linear-gradient(135deg, ${a.palette.primary.main} 0%, ${a.palette.primary.dark} 100%)`,"&:hover":{transform:"scale(1.02)",boxShadow:`0 6px 16px 0 ${x(a.palette.primary.main,.3)}`}},"& .fc .fc-day-today":{"& .fc-daygrid-day-number":{color:a.palette.primary.main,fontWeight:800,fontSize:"1rem",bgcolor:x(a.palette.primary.main,.08),borderRadius:"50%",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",m:.5},bgcolor:"transparent"},"& .fc .fc-list":{border:"none",bgcolor:"transparent"},"& .fc .fc-list-day-cushion":{bgcolor:x(a.palette.primary.main,.05),borderRadius:"8px",m:1},"& .fc .fc-list-event":{borderRadius:"8px",overflow:"hidden","&:hover td":{bgcolor:x(a.palette.primary.main,.05)}}},children:e.jsx($e,{plugins:[Fe,Ie,Ae],initialView:"dayGridMonth",events:n,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,listMonth"},height:"auto",eventColor:a.palette.primary.main,eventTextColor:a.palette.primary.contrastText,displayEventTime:!1,datesSet:o=>{r&&r(o.view.currentStart)}})})})]})}const st=ne`
  0% { left: 100%; transform: translateX(0); }
  100% { left: 0; transform: translateX(-100%); }
`;function at({title:t,subheader:s,list:n,...r}){const i=U();return n.length===0?null:e.jsxs(C,{...r,sx:{p:1.5,display:"flex",alignItems:"center",overflow:"hidden",background:`linear-gradient(135deg, ${x(i.palette.primary.main,1)} 0%, ${x(i.palette.primary.dark,1)} 100%)`,color:"primary.contrastText",borderRadius:1,boxShadow:i.customShadows.z8,position:"relative",height:52,...r.sx},children:[e.jsxs(J,{direction:"row",alignItems:"center",spacing:1.5,sx:{zIndex:1,flexShrink:0,pr:2,borderRight:`1px solid ${x(i.palette.common.white,.2)}`,bgcolor:"primary.main",height:"100%"},children:[e.jsx($,{icon:"solar:volume-loud-bold-duotone",width:24}),e.jsx(p,{variant:"subtitle2",sx:{fontWeight:"bold",textTransform:"uppercase",letterSpacing:1},children:"Announcements"})]}),e.jsx(u,{sx:{flexGrow:1,overflow:"hidden",position:"relative",height:"100%",display:"flex",alignItems:"center"},children:e.jsx(u,{sx:{display:"flex",position:"absolute",whiteSpace:"nowrap",animation:`${st} 40s linear infinite`,animationFillMode:"backwards","&:hover":{animationPlayState:"paused"}},children:n.map((a,o)=>e.jsxs(J,{direction:"row",alignItems:"center",spacing:1,sx:{mx:4},children:[e.jsxs(p,{variant:"subtitle2",sx:{fontWeight:"bold"},children:[a.title,":"]}),e.jsx(p,{variant:"body2",sx:{opacity:.9},children:a.message}),e.jsxs(p,{variant:"caption",sx:{opacity:.6,fontSize:"0.7rem"},children:["(",Ee(a.posting_date),")"]})]},o))})})]})}function Q({title:t,total:s,icon:n,color:r="primary",sx:i,...a}){const o=U();return e.jsxs(C,{sx:[{p:3,display:"flex",alignItems:"center",justifyContent:"space-between"},...Array.isArray(i)?i:[i]],...a,children:[e.jsxs(u,{children:[e.jsx(p,{variant:"subtitle2",sx:{color:"text.secondary",mb:1},children:t}),e.jsx(p,{variant:"h3",children:ie(s)})]}),e.jsx(u,{sx:{width:64,height:64,lineHeight:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:`${r}.main`,bgcolor:x(o.palette.grey[500],.08)},children:n})]})}function Z({title:t,subheader:s,tableData:n,headLabel:r,...i}){return e.jsxs(C,{...i,children:[e.jsx(R,{title:t,subheader:s,sx:{mb:3}}),e.jsx(L,{sx:{overflow:"unset"},children:e.jsx(A,{children:e.jsxs(M,{sx:{minWidth:400},children:[e.jsx(N,{children:e.jsx(j,{children:r.map(a=>e.jsx(l,{children:a.label},a.id))})}),e.jsx(O,{children:n.length===0?e.jsx(j,{children:e.jsx(l,{colSpan:r.length,align:"center",sx:{py:3},children:e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"No data found"})})}):n.map((a,o)=>e.jsx(j,{children:r.map(h=>e.jsx(l,{children:h.id==="index"?o+1:a[h.id]},h.id))},o))})]})})})]})}function he(){const{user:t}=q(),[s,n]=T.useState({announcements:[],total_employees:0,pending_leaves:0,present_today:0,missing_attendance:0,todays_leaves:[],todays_birthdays:[],holidays:[]});T.useEffect(()=>{(async()=>{try{const[a,o,h,m,d,g,b,y]=await Promise.all([Ue(),Be(),Ve(),de(),Ge("today"),He(),Xe(),qe()]);n({announcements:a,todays_birthdays:o,todays_leaves:h,holidays:m,renewals:g,present_today:(d==null?void 0:d.present)||0,missing_attendance:(d==null?void 0:d.missing)||0,pending_leaves:y,total_employees:b})}catch(a){console.error("Failed to load HR dashboard data:",a)}})()},[]);const r=async i=>{try{const a=await de(i.getMonth()+1,i.getFullYear());n(o=>({...o,holidays:a}))}catch(a){console.error("Failed to update holidays:",a)}};return e.jsxs(K,{maxWidth:"xl",children:[e.jsxs(p,{variant:"h4",sx:{mb:{xs:3,md:5}},children:["Hi, ",(t==null?void 0:t.full_name)||"HR User",", Welcome back ðŸ‘‹"]}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{size:{xs:12},children:e.jsx(at,{title:"Latest Announcements",list:s.announcements.map(i=>({title:i.announcement_name,message:i.announcement,posting_date:i.creation}))})}),e.jsx(c,{size:{xs:12,sm:6,md:4},children:e.jsx(Q,{title:"Total Employees",total:s.total_employees||0,icon:e.jsx($,{icon:"solar:users-group-rounded-bold-duotone",width:32})})}),e.jsx(c,{size:{xs:12,sm:6,md:4},children:e.jsx(Q,{title:"Pending Leave Applications",total:s.pending_leaves||0,color:"warning",icon:e.jsx($,{icon:"solar:calendar-date-bold-duotone",width:32})})}),e.jsx(c,{size:{xs:12,sm:6,md:4},children:e.jsx(Q,{title:"Yesterday Missing Attendance",total:s.missing_attendance||0,color:"error",icon:e.jsx($,{icon:"solar:close-circle-bold-duotone",width:32})})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsx(Z,{title:"Today's Leave",tableData:s.todays_leaves,headLabel:[{id:"index",label:"#"},{id:"employee_name",label:"Employee Name"},{id:"leave_type",label:"Leave Type"}]})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsx(Z,{title:"Today's Birthdays",tableData:s.todays_birthdays,headLabel:[{id:"index",label:"#"},{id:"employee_name",label:"Employee Name"},{id:"employee",label:"Employee ID"}]})}),e.jsx(c,{size:{xs:12},children:e.jsx(Z,{title:"Upcoming Renewals",tableData:s.renewals||[],headLabel:[{id:"index",label:"#"},{id:"item_name",label:"Item Name"},{id:"category",label:"Category"},{id:"renewal_date",label:"Renewal Date"},{id:"amount",label:"Amount"},{id:"status",label:"Status"}]})}),e.jsx(c,{size:{xs:12},children:e.jsx(tt,{title:"Holiday Calendar",subheader:"Upcoming holidays for this month",onDateChange:r,events:s.holidays.map(i=>({title:i.description,start:i.holiday_date,color:"#FF4842"}))})})]})]})}const D={root:z("chart__root"),loading:z("chart__loading"),legends:{root:z("chart__legends__root"),item:{wrap:z("chart__legends__item__wrap"),root:z("chart__legends__item__root"),dot:z("chart__legends__item__dot"),icon:z("chart__legends__item__icon"),label:z("chart__legends__item__label"),value:z("chart__legends__item__value")}}};function nt({sx:t,className:s,slotProps:n,icons:r=[],values:i=[],labels:a=[],colors:o=[],sublabels:h=[],...m}){return e.jsx(rt,{className:re([D.legends.root,s]),sx:t,...m,children:a.map((d,g)=>{var b,y,v;return e.jsxs(it,{className:D.legends.item.wrap,sx:[{"--icon-color":o[g],...n==null?void 0:n.wrapper},...Array.isArray((b=n==null?void 0:n.wrapper)==null?void 0:b.sx)?((y=n==null?void 0:n.wrapper)==null?void 0:y.sx)??[]:[(v=n==null?void 0:n.wrapper)==null?void 0:v.sx]],children:[e.jsxs(ot,{className:D.legends.item.root,...n==null?void 0:n.root,children:[r.length?e.jsx(lt,{className:D.legends.item.icon,...n==null?void 0:n.icon,children:r[g]}):e.jsx(ct,{className:D.legends.item.dot,...n==null?void 0:n.dot}),e.jsxs(dt,{className:D.legends.item.label,...n==null?void 0:n.label,children:[d,!!h.length&&e.jsxs(e.Fragment,{children:[" ",` (${h[g]})`]})]})]}),i&&e.jsx(ht,{className:D.legends.item.value,...n==null?void 0:n.value,children:i[g]})]},d)})})}const rt=F("ul")(({theme:t})=>({display:"flex",flexWrap:"wrap",gap:t.spacing(2)})),it=F("li")(()=>({display:"inline-flex",flexDirection:"column"})),ot=F("div")(({theme:t})=>({gap:6,alignItems:"center",display:"inline-flex",justifyContent:"flex-start",fontSize:t.typography.pxToRem(13),fontWeight:t.typography.fontWeightMedium})),lt=F("span")({display:"inline-flex",color:"var(--icon-color)","& > :first-of-type:not(style):not(:first-of-type ~ *), & > style + *":{width:20,height:20}}),ct=F("span")({width:12,height:12,flexShrink:0,display:"flex",borderRadius:"50%",position:"relative",alignItems:"center",justifyContent:"center",color:"var(--icon-color)",backgroundColor:"currentColor"}),dt=F("span")({flexShrink:0}),ht=F("span")(({theme:t})=>({...t.typography.h6,marginTop:t.spacing(1)}));function xt({sx:t,className:s,type:n,...r}){const i=["donut","radialBar","pie","polarArea"];return e.jsx(u,{className:re([D.loading,s]),sx:[()=>({top:0,left:0,width:1,zIndex:9,height:1,p:"inherit",overflow:"hidden",alignItems:"center",position:"absolute",borderRadius:"inherit",justifyContent:"center"}),...Array.isArray(t)?t:[t]],...r,children:e.jsx(et,{variant:"circular",sx:{width:1,height:1,borderRadius:"inherit",...i.includes(n)&&{borderRadius:"50%"}}})})}const mt=T.lazy(()=>ke(()=>import("./react-apexcharts.min-Tw9Uc0mB.js").then(t=>t.r),__vite__mapDeps([0,1,2,3])).then(t=>({default:t.default})));function oe({type:t,series:s,options:n,slotProps:r,className:i,sx:a,...o}){const h=Ce(),m=()=>e.jsx(xt,{type:t,sx:r==null?void 0:r.loading});return e.jsx(pt,{dir:"ltr",className:re([D.root,i]),sx:a,...o,children:h?e.jsx(T.Suspense,{fallback:m(),children:e.jsx(mt,{type:t,series:s,options:n,width:"100%",height:"100%"})}):m()})}const pt=F("div")(({theme:t})=>({width:"100%",flexShrink:0,position:"relative",borderRadius:t.shape.borderRadius*1.5}));function le(t){const s=U(),n=ut(s)??{};return We(n,t??{})}const ut=t=>{const s={show:!0,label:"Total",color:t.vars.palette.text.secondary,fontSize:t.typography.subtitle2.fontSize,fontWeight:t.typography.subtitle2.fontWeight},n={offsetY:8,color:t.vars.palette.text.primary,fontSize:t.typography.h4.fontSize,fontWeight:t.typography.h4.fontWeight};return{chart:{toolbar:{show:!1},zoom:{enabled:!1},parentHeightOffset:0,fontFamily:t.typography.fontFamily,foreColor:t.vars.palette.text.disabled,animations:{enabled:!0,speed:360,animateGradually:{enabled:!0,delay:120},dynamicAnimation:{enabled:!0,speed:360}}},colors:[t.palette.primary.main,t.palette.warning.main,t.palette.info.main,t.palette.error.main,t.palette.success.main,t.palette.warning.dark,t.palette.success.darker,t.palette.info.dark,t.palette.info.darker],states:{hover:{filter:{type:"darken"}},active:{filter:{type:"darken"}}},fill:{opacity:1,gradient:{type:"vertical",shadeIntensity:0,opacityFrom:.4,opacityTo:0,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{width:2.5,curve:"smooth",lineCap:"round"},grid:{strokeDashArray:3,borderColor:t.vars.palette.divider,padding:{top:0,right:0,bottom:0},xaxis:{lines:{show:!1}}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{tickAmount:5},markers:{size:0,strokeColors:t.vars.palette.background.paper},tooltip:{theme:"false",fillSeriesColor:!1,x:{show:!0}},legend:{show:!1,position:"top",fontWeight:500,fontSize:"13px",horizontalAlign:"right",markers:{shape:"circle"},labels:{colors:t.vars.palette.text.primary},itemMargin:{horizontal:8,vertical:8}},plotOptions:{bar:{borderRadius:4,columnWidth:"48%",borderRadiusApplication:"end"},pie:{donut:{labels:{show:!0,value:{...n},total:{...s}}}},radialBar:{hollow:{margin:-8,size:"100%"},track:{margin:-8,strokeWidth:"50%",background:Re(t.vars.palette.grey["500Channel"],.16)},dataLabels:{value:{...n},total:{...s}}},radar:{polygons:{fill:{colors:["transparent"]},strokeColors:t.vars.palette.divider,connectorColors:t.vars.palette.divider}},polarArea:{rings:{strokeColor:t.vars.palette.divider},spokes:{connectorColors:t.vars.palette.divider}},heatmap:{distributed:!0}},responsive:[{breakpoint:t.breakpoints.values.sm,options:{plotOptions:{bar:{borderRadius:3,columnWidth:"80%"}}}},{breakpoint:t.breakpoints.values.md,options:{plotOptions:{bar:{columnWidth:"60%"}}}}]}};function w({sx:t,icon:s,title:n,total:r,chart:i,percent:a,color:o="primary",...h}){const m=U(),d=[m.palette[o].main],g=le({chart:{sparkline:{enabled:!0}},colors:d,xaxis:{categories:i.categories},grid:{padding:{top:6,left:6,right:6,bottom:6}},tooltip:{y:{formatter:y=>ie(y),title:{formatter:()=>""}}},markers:{strokeWidth:0},...i.options}),b=()=>e.jsxs(J,{direction:"row",alignItems:"center",spacing:.5,sx:{px:1,py:.5,borderRadius:.75,typography:"subtitle2",color:a<0?"error.main":"success.main",bgcolor:x(a<0?m.palette.error.main:m.palette.success.main,.08)},children:[e.jsx($,{width:16,icon:a<0?"eva:trending-down-fill":"eva:trending-up-fill"}),e.jsxs(u,{component:"span",children:[a>0&&"+",Me(a)]})]});return e.jsxs(C,{sx:[{p:3,boxShadow:y=>{var v;return(v=y.customShadows)==null?void 0:v.card},position:"relative",display:"flex",flexDirection:"column",backgroundColor:"background.paper",border:y=>`1px solid ${x(y.palette.grey[500],.08)}`,overflow:"hidden","&:before":{top:0,left:0,width:1,height:1,content:"''",position:"absolute",zIndex:1,pointerEvents:"none",backgroundImage:`linear-gradient(135deg, ${x(m.palette[o].main,.01)} 0%, ${x(m.palette[o].main,.05)} 100%)`}},...Array.isArray(t)?t:[t]],...h,children:[e.jsxs(J,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",sx:{mb:3},children:[e.jsx(u,{sx:{width:44,height:44,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:1.25,bgcolor:x(m.palette[o].main,.12),color:`${o}.main`,zIndex:2},children:s}),e.jsx(u,{sx:{zIndex:2},children:b()})]}),e.jsxs(u,{sx:{display:"flex",flexWrap:"wrap",alignItems:"flex-end",justifyContent:"space-between",zIndex:2},children:[e.jsxs(u,{sx:{flexGrow:1,minWidth:112},children:[e.jsx(p,{variant:"subtitle2",sx:{mb:.5,color:"text.secondary",fontWeight:"medium"},children:n}),e.jsx(p,{variant:"h3",sx:{fontWeight:"fontWeightBold"},children:Le(r)})]}),e.jsx(oe,{type:"line",series:[{data:i.series}],options:g,sx:{width:"40%",height:60}})]})]})}function se({title:t,subheader:s,chart:n,chartType:r="bar",sx:i,...a}){const o=U(),h=n.colors??[x(o.palette.primary.dark,.8),x(o.palette.warning.main,.8)],m=le({colors:h,stroke:{width:2,colors:r==="bar"?["transparent"]:void 0},xaxis:{categories:n.categories},legend:{show:!0},tooltip:{y:{formatter:d=>`${d} visits`}},...n.options});return e.jsxs(C,{sx:i,...a,children:[e.jsx(R,{title:t,subheader:s}),e.jsx(oe,{type:r,series:n.series,options:m,slotProps:{loading:{p:2.5}},sx:{pl:1,py:2.5,pr:2.5,height:364}})]})}function gt(){const{user:t}=q(),[s,n]=T.useState({total_sales:0,total_qty_sold:0,total_orders:0,aov:0,gross_sales:0,net_sales:0,total_discounts:0,mtd_sales:0,ytd_sales:0,pipeline_value:0,top_customers_by_revenue:[],most_repeated_customers:[],overdue_orders:[],pending_orders_count:0,sales_trend:{categories:[],series:[]},discount_trend:{categories:[],series:[]},conversion_rate:0});return T.useEffect(()=>{(async()=>{const i=await ge();n(i)})()},[]),e.jsxs(K,{maxWidth:"xl",children:[e.jsxs(p,{variant:"h4",sx:{mb:{xs:3,md:5}},children:["Hi, ",(t==null?void 0:t.full_name)||"User",", Welcome back ðŸ‘‹"]}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Sales",percent:0,total:s.total_sales,icon:e.jsx("img",{alt:"Total Sales",src:"/assets/company/crm/assets/icons/glass/ic-glass-buy.svg"}),chart:{categories:["MTD","YTD"],series:[s.mtd_sales,s.ytd_sales]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"MTD Sales",percent:0,total:s.mtd_sales,color:"secondary",icon:e.jsx("img",{alt:"MTD Sales",src:"/assets/company/crm/assets/icons/glass/ic-glass-bag.svg"}),chart:{categories:["Prev","Current"],series:[s.mtd_sales,s.mtd_sales]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Conversion Rate",percent:0,total:parseFloat(s.conversion_rate.toFixed(2)),color:"warning",icon:e.jsx("img",{alt:"Conversion",src:"/assets/company/crm/assets/icons/glass/ic-glass-message.svg"}),chart:{categories:["Prev","Current"],series:[s.conversion_rate,s.conversion_rate]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Open Pipeline",percent:0,total:s.pipeline_value,icon:e.jsx("img",{alt:"Pipeline",src:"/assets/company/crm/assets/icons/glass/ic-glass-buy.svg"}),chart:{categories:["Prev","Current"],series:[s.pipeline_value,s.pipeline_value]}})}),e.jsx(c,{size:{xs:12,md:12},children:e.jsx(se,{title:"Sales Trend",subheader:"Total Revenue over last 12 months",chart:{categories:s.sales_trend.categories,series:[{name:"Sales",data:s.sales_trend.series}]}})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsxs(C,{children:[e.jsx(R,{title:"Top Customers by Revenue"}),e.jsx(A,{children:e.jsx(L,{sx:{minWidth:400},children:e.jsxs(M,{children:[e.jsx(N,{children:e.jsxs(j,{children:[e.jsx(l,{children:"Customer"}),e.jsx(l,{children:"Revenue"}),e.jsx(l,{align:"center",children:"Orders"})]})}),e.jsx(O,{children:s.top_customers_by_revenue.length>0?s.top_customers_by_revenue.map(r=>e.jsxs(j,{children:[e.jsx(l,{children:r.billing_name}),e.jsx(l,{children:X(r.revenue)}),e.jsx(l,{align:"center",children:r.order_count})]},r.client_name)):e.jsx(j,{children:e.jsx(l,{colSpan:3,children:e.jsxs(u,{sx:{py:8,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(u,{component:"img",src:"/assets/company/crm/assets/icons/glass/ic-glass-users.svg",sx:{width:48,height:48,opacity:.3}}),e.jsx(p,{variant:"body2",color:"text.secondary",children:"No customer data available"})]})})})})]})})})]})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsxs(C,{children:[e.jsx(R,{title:"Overdue Orders"}),e.jsx(A,{children:e.jsx(L,{sx:{minWidth:400},children:e.jsxs(M,{children:[e.jsx(N,{children:e.jsxs(j,{children:[e.jsx(l,{children:"Order ID"}),e.jsx(l,{children:"Customer"}),e.jsx(l,{children:"Due Date"}),e.jsx(l,{align:"right",children:"Balance"})]})}),e.jsx(O,{children:s.overdue_orders.length>0?s.overdue_orders.map(r=>e.jsxs(j,{children:[e.jsx(l,{children:r.name}),e.jsx(l,{children:r.billing_name}),e.jsx(l,{children:r.due_date}),e.jsx(l,{align:"right",children:X(r.balance_amount)})]},r.name)):e.jsx(j,{children:e.jsx(l,{colSpan:4,children:e.jsxs(u,{sx:{py:8,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(u,{component:"img",src:"/assets/company/crm/assets/icons/glass/ic-glass-buy.svg",sx:{width:48,height:48,opacity:.3}}),e.jsx(p,{variant:"body2",color:"text.secondary",children:"No overdue orders"})]})})})})]})})})]})}),e.jsx(c,{size:{xs:12,md:12},children:e.jsx(se,{title:"Discount Trend",subheader:"Total Discounts given over last 12 months",chart:{categories:s.discount_trend.categories,series:[{name:"Discounts",data:s.discount_trend.series}]}})})]})]})}function yt({title:t,subheader:s,calls:n}){const r=a=>new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),i=a=>a==="Completed"?"success":a==="Scheduled"?"info":"default";return e.jsxs(C,{sx:{border:a=>`1px solid ${x(a.palette.grey[500],.08)}`,boxShadow:a=>{var o;return(o=a.customShadows)==null?void 0:o.card}},children:[e.jsx(R,{title:t,subheader:s,sx:{mb:1},titleTypographyProps:{variant:"h6"}}),e.jsx(A,{children:e.jsx(L,{sx:{overflow:"unset"},children:e.jsxs(M,{sx:{minWidth:400},children:[e.jsx(N,{children:e.jsxs(j,{sx:{bgcolor:a=>x(a.palette.grey[500],.04)},children:[e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Title"}),e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Related To"}),e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Time"}),e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Status"})]})}),e.jsxs(O,{children:[n.map(a=>e.jsxs(j,{hover:!0,children:[e.jsx(l,{children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(u,{sx:{width:32,height:32,borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:o=>x(o.palette.primary.main,.1),color:"primary.main"},children:e.jsx($,{icon:"solar:phone-calling-rounded-bold",width:18})}),e.jsx(p,{variant:"subtitle2",sx:{fontWeight:"600"},children:a.title||"Untitled Call"})]})}),e.jsx(l,{children:e.jsxs(p,{variant:"body2",sx:{color:"text.secondary"},children:[a.call_for," ",a.lead_name?`â€¢ ${a.lead_name}`:""]})}),e.jsxs(l,{children:[e.jsx(p,{variant:"body2",sx:{fontWeight:"500"},children:r(a.call_start_time)}),a.call_end_time&&e.jsxs(p,{variant:"caption",sx:{color:"text.disabled",display:"block"},children:["ends ",r(a.call_end_time)]})]}),e.jsx(l,{children:e.jsx(me,{color:i(a.outgoing_call_status),variant:"soft",sx:{fontWeight:"bold"},children:a.outgoing_call_status||"Scheduled"})})]},a.name)),n.length===0&&e.jsx(j,{children:e.jsx(l,{colSpan:4,align:"center",children:e.jsxs(u,{sx:{py:6},children:[e.jsx($,{icon:"solar:history-bold-duotone",width:48,sx:{color:"text.disabled",mb:1,opacity:.24}}),e.jsx(p,{variant:"body2",sx:{color:"text.disabled"},children:"No calls scheduled for today"})]})})})]})]})})})]})}function ft({title:t,subheader:s,meetings:n}){const r=a=>new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),i=a=>a==="Completed"?"success":a==="Scheduled"?"info":"default";return e.jsxs(C,{sx:{border:a=>`1px solid ${x(a.palette.grey[500],.08)}`,boxShadow:a=>{var o;return(o=a.customShadows)==null?void 0:o.card}},children:[e.jsx(R,{title:t,subheader:s,sx:{mb:1},titleTypographyProps:{variant:"h6"}}),e.jsx(A,{children:e.jsx(L,{sx:{overflow:"unset"},children:e.jsxs(M,{sx:{minWidth:400},children:[e.jsx(N,{children:e.jsxs(j,{sx:{bgcolor:a=>x(a.palette.grey[500],.04)},children:[e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Title"}),e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Related To"}),e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Time"}),e.jsx(l,{sx:{color:"text.secondary",fontWeight:"bold"},children:"Status"})]})}),e.jsxs(O,{children:[n.map(a=>e.jsxs(j,{hover:!0,children:[e.jsx(l,{children:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(u,{sx:{width:32,height:32,borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:o=>x(o.palette.warning.main,.1),color:"warning.main"},children:e.jsx($,{icon:"solar:calendar-add-bold",width:18})}),e.jsx(p,{variant:"subtitle2",sx:{fontWeight:"600"},children:a.title})]})}),e.jsx(l,{children:e.jsxs(p,{variant:"body2",sx:{color:"text.secondary"},children:[a.meet_for," ",a.lead_name?`â€¢ ${a.lead_name}`:""]})}),e.jsxs(l,{children:[e.jsx(p,{variant:"body2",sx:{fontWeight:"500"},children:r(a.from)}),a.to&&e.jsxs(p,{variant:"caption",sx:{color:"text.disabled",display:"block"},children:["ends ",r(a.to)]})]}),e.jsx(l,{children:e.jsx(me,{color:i(a.outgoing_call_status),variant:"soft",sx:{fontWeight:"bold"},children:a.outgoing_call_status||"Scheduled"})})]},a.name)),n.length===0&&e.jsx(j,{children:e.jsx(l,{colSpan:4,align:"center",children:e.jsxs(u,{sx:{py:6},children:[e.jsx($,{icon:"solar:calendar-mark-bold-duotone",width:48,sx:{color:"text.disabled",mb:1,opacity:.24}}),e.jsx(p,{variant:"body2",sx:{color:"text.disabled"},children:"No meetings scheduled for today"})]})})})]})]})})})]})}function ye({calls:t,meetings:s}){return e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{size:{xs:12,md:6},children:e.jsx(yt,{title:"Today's Calls",subheader:`${t.length} scheduled calls`,calls:t})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsx(ft,{title:"Today's Meetings",subheader:`${s.length} scheduled meetings`,meetings:s})})]})}function ae({title:t,subheader:s,chart:n,sx:r,...i}){const a=U(),o=n.series.map(d=>d.value),h=n.colors??[a.palette.primary.main,a.palette.warning.light,a.palette.info.dark,a.palette.error.main],m=le({chart:{sparkline:{enabled:!0}},colors:h,labels:n.series.map(d=>d.label),stroke:{width:0},dataLabels:{enabled:!0,dropShadow:{enabled:!1}},tooltip:{y:{formatter:d=>ie(d),title:{formatter:d=>`${d}`}}},plotOptions:{pie:{donut:{labels:{show:!1}}}},...n.options});return e.jsxs(C,{sx:{border:d=>`1px solid ${x(d.palette.grey[500],.08)}`,boxShadow:d=>{var g;return(g=d.customShadows)==null?void 0:g.card},...r},...i,children:[e.jsx(R,{title:t,subheader:s,titleTypographyProps:{variant:"h6"}}),e.jsx(oe,{type:"pie",series:o,options:m,sx:{my:3,mx:"auto",width:"100%",maxWidth:{xs:240,xl:320},height:{xs:240,xl:320}}}),e.jsx(ze,{sx:{borderStyle:"dashed"}}),e.jsx(nt,{labels:m==null?void 0:m.labels,colors:m==null?void 0:m.colors,sx:{p:3,justifyContent:"center"}})]})}function jt(){var g,b,y,v,_,H,B,V,S,E,I,ce;const{user:t}=q(),[s,n]=T.useState({total_sales:0,total_qty_sold:0,total_orders:0,aov:0,gross_sales:0,net_sales:0,total_discounts:0,mtd_sales:0,ytd_sales:0,pipeline_value:0,top_customers_by_revenue:[],most_repeated_customers:[],overdue_orders:[],pending_orders_count:0,sales_trend:{categories:[],series:[]},discount_trend:{categories:[],series:[]},conversion_rate:0}),[r,i]=T.useState({leads:0,contacts:0,deals:0,accounts:0,recent_leads:0,total_deal_value:0,leads_by_status:[],deals_by_stage:[],charts:{categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],leads:[0,0,0,0,0,0,0],contacts:[0,0,0,0,0,0,0],deals:[0,0,0,0,0,0,0],accounts:[0,0,0,0,0,0,0]}}),[a,o]=T.useState({calls:[],meetings:[]}),[h,m]=T.useState({invoices:{total:0,count:0,chart:[0,0,0,0,0,0,0]},estimations:{total:0,count:0,chart:[0,0,0,0,0,0,0]},purchases:{total:0,count:0,chart:[0,0,0,0,0,0,0]},expenses:{total:0,count:0,chart:[0,0,0,0,0,0,0]},categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]});T.useEffect(()=>{(async()=>{const[Y,G,fe,je]=await Promise.all([ge(),pe(),ue(),Ye()]);n(Y),i(G),o(fe),m(je)})()},[]);const d=(f=[])=>{if(f.length<2)return 0;const Y=f[f.length-1],G=f[f.length-2];return G===0?Y>0?100:0:Math.round((Y-G)/G*100)};return e.jsxs(K,{maxWidth:"xl",children:[e.jsxs(p,{variant:"h4",sx:{mb:{xs:3,md:5}},children:["Hi, ",(t==null?void 0:t.full_name)||"User",", Welcome back ðŸ‘‹"]}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Leads",percent:d((g=r.charts)==null?void 0:g.leads),total:r.leads||0,icon:e.jsx("img",{alt:"Leads",src:"/assets/company/crm/assets/icons/glass/ic-glass-users.svg"}),chart:{categories:((b=r.charts)==null?void 0:b.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((y=r.charts)==null?void 0:y.leads)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Contacts",percent:d((v=r.charts)==null?void 0:v.contacts),total:r.contacts||0,color:"secondary",icon:e.jsx("img",{alt:"Contacts",src:"/assets/company/crm/assets/icons/glass/ic-glass-message.svg"}),chart:{categories:((_=r.charts)==null?void 0:_.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((H=r.charts)==null?void 0:H.contacts)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Deals",percent:d((B=r.charts)==null?void 0:B.deals),total:r.deals||0,color:"warning",icon:e.jsx("img",{alt:"Deals",src:"/assets/company/crm/assets/icons/glass/ic-glass-buy.svg"}),chart:{categories:((V=r.charts)==null?void 0:V.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((S=r.charts)==null?void 0:S.deals)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Accounts",percent:d((E=r.charts)==null?void 0:E.accounts),total:r.accounts||0,color:"info",icon:e.jsx("img",{alt:"Accounts",src:"/assets/company/crm/assets/icons/glass/ic-glass-users.svg"}),chart:{categories:((I=r.charts)==null?void 0:I.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((ce=r.charts)==null?void 0:ce.accounts)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Invoices",percent:d(h.invoices.chart),total:h.invoices.count,icon:e.jsx("img",{alt:"Invoices",src:"/assets/company/crm/assets/icons/glass/ic-glass-buy.svg"}),chart:{categories:h.categories,series:h.invoices.chart}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Estimations",percent:d(h.estimations.chart),total:h.estimations.count,color:"secondary",icon:e.jsx("img",{alt:"Estimations",src:"/assets/company/crm/assets/icons/glass/ic-glass-bag.svg"}),chart:{categories:h.categories,series:h.estimations.chart}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Purchases",percent:d(h.purchases.chart),total:h.purchases.count,color:"warning",icon:e.jsx("img",{alt:"Purchases",src:"/assets/company/crm/assets/icons/glass/ic-glass-message.svg"}),chart:{categories:h.categories,series:h.purchases.chart}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Expenses",percent:d(h.expenses.chart),total:h.expenses.count,color:"info",icon:e.jsx("img",{alt:"Expenses",src:"/assets/company/crm/assets/icons/glass/ic-glass-users.svg"}),chart:{categories:h.categories,series:h.expenses.chart}})}),e.jsx(c,{size:{xs:12,md:8},children:e.jsx(se,{title:"Sales & Discount Trend",subheader:"Total Revenue vs Total Discount over last 12 months",chartType:"line",chart:{categories:s.sales_trend.categories,series:[{name:"Total Revenue",data:s.sales_trend.series},{name:"Total Discount",data:s.discount_trend.series}],options:{tooltip:{y:{formatter:f=>X(f)}}}},sx:{height:1}})}),e.jsx(c,{size:{xs:12,md:4},children:e.jsx(ae,{title:"Leads by Status",chart:{series:(r.leads_by_status||[]).map(f=>({label:f.status,value:f.count}))},sx:{height:1}})}),e.jsx(c,{size:{xs:12},children:e.jsx(ye,{calls:a.calls||[],meetings:a.meetings||[]})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsxs(C,{children:[e.jsx(R,{title:"Top Customers by Revenue"}),e.jsx(A,{children:e.jsx(L,{sx:{minWidth:400},children:e.jsxs(M,{children:[e.jsx(N,{children:e.jsxs(j,{children:[e.jsx(l,{children:"Customer"}),e.jsx(l,{children:"Revenue"}),e.jsx(l,{align:"center",children:"Orders"})]})}),e.jsx(O,{children:s.top_customers_by_revenue.length>0?s.top_customers_by_revenue.map(f=>e.jsxs(j,{children:[e.jsx(l,{children:f.billing_name}),e.jsx(l,{children:X(f.revenue)}),e.jsx(l,{align:"center",children:f.order_count})]},f.client_name)):e.jsx(j,{children:e.jsx(l,{colSpan:3,children:e.jsxs(u,{sx:{py:8,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(u,{component:"img",src:"/assets/company/crm/assets/icons/glass/ic-glass-users.svg",sx:{width:48,height:48,opacity:.3}}),e.jsx(p,{variant:"body2",color:"text.secondary",children:"No customer data available"})]})})})})]})})})]})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsxs(C,{children:[e.jsx(R,{title:"Overdue Orders"}),e.jsx(A,{children:e.jsx(L,{sx:{minWidth:400},children:e.jsxs(M,{children:[e.jsx(N,{children:e.jsxs(j,{children:[e.jsx(l,{children:"Order ID"}),e.jsx(l,{children:"Customer"}),e.jsx(l,{children:"Due Date"}),e.jsx(l,{align:"right",children:"Balance"})]})}),e.jsx(O,{children:s.overdue_orders.length>0?s.overdue_orders.map(f=>e.jsxs(j,{children:[e.jsx(l,{children:f.name}),e.jsx(l,{children:f.billing_name}),e.jsx(l,{children:f.due_date}),e.jsx(l,{align:"right",children:X(f.balance_amount)})]},f.name)):e.jsx(j,{children:e.jsx(l,{colSpan:4,children:e.jsxs(u,{sx:{py:8,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(u,{component:"img",src:"/assets/company/crm/assets/icons/glass/ic-glass-buy.svg",sx:{width:48,height:48,opacity:.3}}),e.jsx(p,{variant:"body2",color:"text.secondary",children:"No overdue orders"})]})})})})]})})})]})})]})]})}function P(){var o,h,m,d,g,b,y,v,_,H,B,V;const{user:t}=q(),[s,n]=T.useState({leads:0,contacts:0,deals:0,accounts:0,recent_leads:0,total_deal_value:0,leads_by_status:[],deals_by_stage:[],charts:{categories:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],leads:[0,0,0,0,0,0,0],contacts:[0,0,0,0,0,0,0],deals:[0,0,0,0,0,0,0],accounts:[0,0,0,0,0,0,0]}}),[r,i]=T.useState({calls:[],meetings:[]});T.useEffect(()=>{(async()=>{const[E,I]=await Promise.all([pe(),ue()]);n(E),i(I)})()},[]);const a=(S=[])=>{if(S.length<2)return 0;const E=S[S.length-1],I=S[S.length-2];return I===0?E>0?100:0:Math.round((E-I)/I*100)};return e.jsxs(K,{maxWidth:"xl",children:[e.jsxs(p,{variant:"h4",sx:{mb:{xs:3,md:5}},children:["Hi, ",(t==null?void 0:t.full_name)||"User",", Welcome back ðŸ‘‹"]}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Leads",percent:a((o=s==null?void 0:s.charts)==null?void 0:o.leads),total:(s==null?void 0:s.leads)||0,icon:e.jsx("img",{alt:"Leads",src:"/assets/company/crm/assets/icons/glass/ic-glass-users.svg"}),chart:{categories:((h=s==null?void 0:s.charts)==null?void 0:h.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((m=s==null?void 0:s.charts)==null?void 0:m.leads)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Contacts",percent:a((d=s==null?void 0:s.charts)==null?void 0:d.contacts),total:(s==null?void 0:s.contacts)||0,color:"secondary",icon:e.jsx("img",{alt:"Contacts",src:"/assets/company/crm/assets/icons/glass/ic-glass-message.svg"}),chart:{categories:((g=s==null?void 0:s.charts)==null?void 0:g.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((b=s==null?void 0:s.charts)==null?void 0:b.contacts)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Deals",percent:a((y=s==null?void 0:s.charts)==null?void 0:y.deals),total:(s==null?void 0:s.deals)||0,color:"warning",icon:e.jsx("img",{alt:"Deals",src:"/assets/company/crm/assets/icons/glass/ic-glass-buy.svg"}),chart:{categories:((v=s==null?void 0:s.charts)==null?void 0:v.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((_=s==null?void 0:s.charts)==null?void 0:_.deals)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,sm:6,md:3},children:e.jsx(w,{title:"Total Accounts",percent:a((H=s==null?void 0:s.charts)==null?void 0:H.accounts),total:(s==null?void 0:s.accounts)||0,color:"info",icon:e.jsx("img",{alt:"Accounts",src:"/assets/company/crm/assets/icons/glass/ic-glass-users.svg"}),chart:{categories:((B=s==null?void 0:s.charts)==null?void 0:B.categories)||["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:((V=s==null?void 0:s.charts)==null?void 0:V.accounts)||[0,0,0,0,0,0,0]}})}),e.jsx(c,{size:{xs:12,md:12,lg:12},children:e.jsx(ye,{calls:(r==null?void 0:r.calls)||[],meetings:(r==null?void 0:r.meetings)||[]})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsx(ae,{title:"Leads by Status",chart:{series:((s==null?void 0:s.leads_by_status)||[]).map(S=>({label:S.status,value:S.count}))}})}),e.jsx(c,{size:{xs:12,md:6},children:e.jsx(ae,{title:"Deals by Stage",chart:{series:((s==null?void 0:s.deals_by_stage)||[]).map(S=>({label:S.stage,value:S.count}))}})})]})]})}function It(){var m,d,g,b,y,v;const{user:t}=q(),s=(m=t==null?void 0:t.roles)==null?void 0:m.some(_=>_.toLowerCase()==="hr"),n=(d=t==null?void 0:t.roles)==null?void 0:d.some(_=>_.toLowerCase()==="employee"),r=(g=t==null?void 0:t.roles)==null?void 0:g.some(_=>_.toLowerCase()==="sales"),i=(b=t==null?void 0:t.roles)==null?void 0:b.some(_=>_.toLowerCase()==="crm user"),a=(y=t==null?void 0:t.roles)==null?void 0:y.some(_=>_.toLowerCase()==="crm and sales"),o=(v=t==null?void 0:t.roles)==null?void 0:v.some(_=>["administrator","system manager"].includes(_.toLowerCase())),h=()=>o?e.jsx(P,{}):a?e.jsx(jt,{}):r?e.jsx(gt,{}):i?e.jsx(P,{}):s?e.jsx(he,{}):n?e.jsx(he,{}):e.jsx(P,{});return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Dashboard - ${De.appName}`}),e.jsx("meta",{name:"description",content:"Innoblitz ERP"}),e.jsx("meta",{name:"keywords",content:"Innoblitz ERP"}),h()]})}export{It as default};
