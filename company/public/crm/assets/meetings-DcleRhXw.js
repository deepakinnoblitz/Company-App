import{h as F,r as a,j as t,p as h,I as H,B as R,w as z}from"./index-Co7v2xsC.js";import{C as W}from"./config-global-BX9xwJzv.js";import{d as c}from"./dayjs.min-C2542nnJ.js";import{F as E,i as G,a as I,b as T}from"./index-DcBM0rMB.js";import{i as O}from"./index-BLaIkoYk.js";import{D as $,C as N}from"./Card-CDV3jV6O.js";import{f as B,u as x,d as A}from"./meetings-CH-Mye0X.js";import{C as V}from"./confirm-dialog--19ddTk_.js";import{M as _}from"./meeting-dialog-CkNJOBVP.js";import{C as L}from"./CardHeader-CmhzWAj1.js";import{S as P}from"./Snackbar-BVA3LOhi.js";import"./api-error-handler-CV6pRVHb.js";import"./utils-CQVN1UoU.js";import"./DialogContent-DtP-sWqR.js";import"./DialogTitle-C3eBZids.js";import"./DialogActions-h_2rRG3x.js";import"./string-DcbcEmw6.js";import"./leads-d5FzXGcx.js";import"./AdapterDayjs-BPhbSeWE.js";import"./index-Chjiymov.js";import"./useThemeProps-BDg4jra0.js";import"./useFormControl-Cqn8lfES.js";import"./Popper-DDlcgFVJ.js";import"./Select-B1EkSlUY.js";import"./visuallyHidden-Dan1xhjv.js";import"./TextField-BmVWmDzd.js";import"./Chip-Rg4Dn3a5.js";import"./Grid-BdmJn5bP.js";import"./Autocomplete-BIV6h0T7.js";import"./usePreviousProps-CVIlMhUg.js";import"./DateTimePicker-jnzvj6J0.js";import"./Tabs-oMX5aKw-.js";import"./KeyboardArrowRight-CBVMFcL2.js";import"./timeViewRenderers-BsmXZnvp.js";function U(){const r=F(),[f,y]=a.useState([]),[d,m]=a.useState(null),[b,l]=a.useState(!1),[v,g]=a.useState({open:!1,id:null}),[p,s]=a.useState({open:!1,message:"",severity:"success"}),n=a.useCallback(async(e,o)=>{try{const i=e==null?void 0:e.toISOString(),u=o==null?void 0:o.toISOString(),Y=await B(i,u);y(Y)}catch(i){console.error("Failed to load meetings:",i)}},[]);a.useEffect(()=>{n()},[n]);const C=e=>{n(e.start,e.end)},M=e=>{const o=e.event.id,i=f.find(u=>u.name===o);i&&(m(i),l(!0))},D=()=>{m(null),l(!0)},S=async e=>{const{event:o}=e;try{await x(o.id,{from:c(o.start).format("YYYY-MM-DD HH:mm:ss"),to:o.end?c(o.end).format("YYYY-MM-DD HH:mm:ss"):void 0}),n()}catch(i){console.error("Failed to update meeting position:",i),s({open:!0,message:i.message||"Failed to update meeting position",severity:"error"}),e.revert()}},w=async e=>{const{event:o}=e;try{await x(o.id,{from:c(o.start).format("YYYY-MM-DD HH:mm:ss"),to:o.end?c(o.end).format("YYYY-MM-DD HH:mm:ss"):void 0}),n()}catch(i){console.error("Failed to update meeting duration:",i),s({open:!0,message:i.message||"Failed to update meeting duration",severity:"error"}),e.revert()}},k=async()=>{if(d)try{await A(d.name),l(!1),g({open:!1,id:null}),n(),s({open:!0,message:"Meeting deleted successfully",severity:"success"})}catch(e){console.error("Failed to delete meeting:",e),s({open:!0,message:e.message||"Failed to delete meeting",severity:"error"})}},j=f.map(e=>({id:e.name,title:e.title||"Untitled Meeting",start:e.from,end:e.to,color:e.outgoing_call_status==="Completed"?r.palette.success.main:r.palette.warning.main}));return t.jsxs($,{children:[t.jsxs(N,{sx:{display:"flex",flexDirection:"column"},children:[t.jsx(L,{title:"Meetings Calendar",subheader:"Manage your scheduled meetings",action:t.jsx(h,{variant:"contained",onClick:D,startIcon:t.jsx(H,{icon:"mingcute:add-line"}),children:"New Meeting"}),sx:{mb:1}}),t.jsx(R,{sx:{p:3,pt:0,"& .fc":{"--fc-border-color":r.palette.divider,"--fc-daygrid-event-dot-width":"8px","--fc-list-event-dot-width":"10px","--fc-today-bg-color":r.palette.primary.lighter},"& .fc .fc-toolbar":{mb:3,gap:1.5,flexDirection:{xs:"column",md:"row"},"& .fc-toolbar-title":{fontSize:"1.25rem",fontWeight:700}},"& .fc .fc-button":{border:"none",py:"8px",px:"12px",borderRadius:"8px",fontSize:"0.875rem",fontWeight:600,textTransform:"capitalize",backgroundColor:r.palette.background.neutral,color:r.palette.text.primary,transition:r.transitions.create(["background-color","color","box-shadow"]),"&:hover":{backgroundColor:r.palette.action.hover},"&:focus":{boxShadow:"none"},"&.fc-button-active":{backgroundColor:"#08a3cd",color:r.palette.common.white,"&:hover":{backgroundColor:"#068eb1"}},"&.fc-today-button":{border:"1px solid #08a3cd","&:disabled":{opacity:.48}}},"& .fc .fc-col-header-cell":{py:1.5,backgroundColor:"#08a3cd",color:r.palette.common.white,"&:first-of-type":{borderTopLeftRadius:"12px"},"&:last-of-type":{borderTopRightRadius:"12px"},"& .fc-col-header-cell-cushion":{textDecoration:"none",fontSize:"0.875rem",fontWeight:700}},"& .fc-view-harness":{borderRadius:"12px",overflow:"hidden",border:`1px solid ${r.palette.divider}`},"& .fc-scrollgrid":{border:"none"},"& .fc .fc-daygrid-day":{"&:hover":{backgroundColor:r.palette.action.hover}},"& .fc .fc-daygrid-day-number":{p:1.5,fontSize:"0.875rem",fontWeight:600,color:r.palette.text.primary},"& .fc .fc-event":{border:"none",borderRadius:"6px",fontWeight:600,fontSize:"0.75rem",mx:"4px",my:"1px",p:"2px 4px",cursor:"pointer"},"& .fc .fc-daygrid-event":{boxShadow:"none"},"& .fc .fc-list":{border:"none","& .fc-list-day-cushion":{backgroundColor:r.palette.background.neutral}}},children:t.jsx(E,{plugins:[G,O,I,T],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:"dayGridMonth",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:3,weekends:!0,events:j,datesSet:C,eventClick:M,eventDrop:S,eventResize:w,select:e=>{m(null),l(!0)},height:"auto",eventDisplay:"block",eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},views:{dayGridMonth:{titleFormat:{year:"numeric",month:"long"}},timeGridWeek:{titleFormat:{year:"numeric",month:"short",day:"numeric"}},timeGridDay:{titleFormat:{year:"numeric",month:"long",day:"numeric"}}}})})]}),t.jsx(_,{open:b,onClose:()=>l(!1),selectedMeeting:d,onSuccess:n}),t.jsx(V,{open:v.open,onClose:()=>g({open:!1,id:null}),title:"Confirm Delete",content:"Are you sure you want to delete this meeting?",action:t.jsx(h,{onClick:k,color:"error",variant:"contained",sx:{borderRadius:1.5,minWidth:100},children:"Delete"})}),t.jsx(P,{open:p.open,autoHideDuration:6e3,onClose:()=>s(e=>({...e,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},children:t.jsx(z,{onClose:()=>s(e=>({...e,open:!1})),severity:p.severity,sx:{width:"100%"},children:p.message})})]})}function Ye(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:`Meetings - ${W.appName}`}),t.jsx(U,{})]})}export{Ye as default};
