import{W as R,r as d,j as e,B as t,I as a,T as o,p,D as k,S as z,w as B,Z as F}from"./index-Co7v2xsC.js";import{C as q}from"./config-global-BX9xwJzv.js";import"./dayjs.min-C2542nnJ.js";import{D as y,C as N}from"./Card-CDV3jV6O.js";import{g as O,d as P}from"./expenses-deJDgINb.js";import{L as $}from"./label-BpZ9ieER.js";import"./styles-wAmuuHpw.js";import{C as G}from"./confirm-dialog--19ddTk_.js";import{S as v}from"./Stack-GQIY7Xk9.js";import{T as H,a as Q,b as M,c as W,d as l,e as U}from"./TableRow-DqeBPnxy.js";import{S as V}from"./Snackbar-BVA3LOhi.js";import{A as Z}from"./AlertTitle-BbqQne_Q.js";import"./api-error-handler-CV6pRVHb.js";import"./DialogContent-DtP-sWqR.js";import"./DialogTitle-C3eBZids.js";import"./DialogActions-h_2rRG3x.js";function J({id:n}){var S,w,D,T;const i=R(),[s,j]=d.useState(null),[u,L]=d.useState(!0),[b,C]=d.useState(!1),[_,f]=d.useState(!1),[x,m]=d.useState({open:!1,message:"",severity:"success"});d.useEffect(()=>{n&&O(n).then(j).catch(r=>{console.error("Failed to fetch expense details:",r),m({open:!0,message:"Failed to load expense details",severity:"error"})}).finally(()=>L(!1))},[n]);const A=async()=>{if(n)try{C(!0),await P(n),m({open:!0,message:"Expense deleted successfully",severity:"success"}),setTimeout(()=>i.push("/expenses"),1500)}catch(r){console.error("Failed to delete expense:",r),m({open:!0,message:"Failed to delete expense",severity:"error"})}finally{C(!1),f(!1)}};return u?e.jsx(y,{children:e.jsx(t,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:20},children:e.jsx(a,{icon:"svg-spinners:12-dots-scale-rotate",width:40,sx:{color:"primary.main"}})})}):s?e.jsxs(y,{children:[e.jsxs(v,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsxs(o,{variant:"h4",children:["Expense: ",s.expense_no||n]}),e.jsxs(v,{direction:"row",spacing:2,children:[e.jsx(p,{variant:"outlined",color:"inherit",onClick:()=>i.push("/expenses"),startIcon:e.jsx(a,{icon:"solar:arrow-left-bold"}),children:"Back to List"}),e.jsx(p,{variant:"contained",color:"error",onClick:()=>f(!0),startIcon:e.jsx(a,{icon:"solar:trash-bin-trash-bold"}),children:"Delete"}),e.jsx(p,{variant:"contained",color:"primary",onClick:()=>i.push(`/expenses/${encodeURIComponent(n||"")}/edit`),startIcon:e.jsx(a,{icon:"solar:pen-bold"}),children:"Edit Expense"})]})]}),e.jsx(N,{sx:{p:4},children:e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:5},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",gap:2.5},children:[e.jsx(t,{sx:{width:64,height:64,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"error.lighter",color:"error.main"},children:e.jsx(a,{icon:"solar:bill-list-bold",width:32})}),e.jsxs(t,{sx:{flexGrow:1},children:[e.jsx(o,{variant:"h5",sx:{fontWeight:800},children:s.expense_category}),e.jsxs(o,{variant:"body2",sx:{color:"text.secondary",fontWeight:600},children:["Expense No: ",s.expense_no||"-"]})]}),e.jsxs(t,{sx:{textAlign:"right"},children:[e.jsx($,{variant:"soft",color:"error",children:"Expense"}),e.jsxs(o,{variant:"caption",sx:{display:"block",mt:1,color:"text.disabled",fontWeight:700},children:["ID: ",s.name]})]})]}),e.jsx(k,{sx:{borderStyle:"dashed"}}),e.jsxs(t,{children:[e.jsx(h,{title:"Expense Details",icon:"solar:info-circle-bold"}),e.jsxs(t,{sx:{display:"grid",gap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:[e.jsx(c,{label:"Expense Category",value:s.expense_category,icon:"solar:tag-bold"}),e.jsx(c,{label:"Expense No",value:s.expense_no,icon:"solar:document-text-bold"}),e.jsx(c,{label:"Date",value:s.date,icon:"solar:calendar-date-bold"}),e.jsx(c,{label:"Payment Type",value:s.payment_type,icon:"solar:bank-note-bold",color:"primary.main"}),e.jsx(c,{label:"Total Amount",value:`₹${((S=s.total)==null?void 0:S.toLocaleString())||0}`,icon:"solar:wallet-money-bold",color:"success.main"})]})]}),s.table_qecz&&s.table_qecz.length>0&&e.jsxs(t,{children:[e.jsx(h,{title:"Items",icon:"solar:list-bold"}),e.jsx(H,{component:t,sx:{mt:2,border:r=>`solid 1px ${r.palette.divider}`,borderRadius:1.5},children:e.jsx(z,{children:e.jsxs(Q,{size:"small",sx:{minWidth:640},children:[e.jsx(M,{sx:{bgcolor:"background.neutral"},children:e.jsxs(W,{children:[e.jsx(l,{sx:{fontWeight:800},children:"Item"}),e.jsx(l,{sx:{fontWeight:800},children:"Qty"}),e.jsx(l,{sx:{fontWeight:800},children:"Price"}),e.jsx(l,{sx:{fontWeight:800},align:"right",children:"Amount"})]})}),e.jsx(U,{children:(w=s.table_qecz)==null?void 0:w.map((r,g)=>{var E,I;return e.jsxs(W,{children:[e.jsx(l,{children:r.items}),e.jsx(l,{children:r.quantity}),e.jsxs(l,{children:["₹",((E=r.price)==null?void 0:E.toLocaleString())||0]}),e.jsxs(l,{align:"right",children:["₹",((I=r.amount)==null?void 0:I.toLocaleString())||0]})]},g)})})]})})})]}),e.jsxs(t,{sx:{alignSelf:"flex-end",minWidth:300},children:[e.jsx(h,{title:"Totals",icon:"solar:bill-list-bold"}),e.jsxs(v,{spacing:1.5,sx:{mt:2},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",sx:{color:"text.secondary"},children:"Total Qty"}),e.jsx(o,{variant:"subtitle2",children:((D=s.table_qecz)==null?void 0:D.reduce((r,g)=>r+(g.quantity||0),0))||0})]}),e.jsx(k,{sx:{borderStyle:"dashed"}}),e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"subtitle1",sx:{fontWeight:800},children:"Grand Total"}),e.jsxs(o,{variant:"subtitle1",sx:{fontWeight:800,color:"primary.main"},children:["₹",((T=s.total)==null?void 0:T.toLocaleString())||0]})]})]})]}),s.description&&e.jsxs(t,{children:[e.jsx(h,{title:"Description",icon:"solar:document-text-bold"}),e.jsx(o,{variant:"body2",sx:{color:"text.secondary",whiteSpace:"pre-wrap"},children:s.description})]}),e.jsxs(t,{sx:{p:3,bgcolor:"background.neutral",borderRadius:2},children:[e.jsx(h,{title:"System Information",icon:"solar:clock-circle-bold",noMargin:!0}),e.jsxs(t,{sx:{mt:3,display:"grid",gap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(c,{label:"Created On",value:new Date(s.creation).toLocaleString(),icon:"solar:calendar-date-bold"}),e.jsx(c,{label:"Created By",value:s.owner,icon:"solar:user-rounded-bold"})]})]})]})}),e.jsx(V,{open:x.open,autoHideDuration:6e3,onClose:()=>m({...x,open:!1}),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(B,{severity:x.severity,sx:{width:"100%",boxShadow:r=>r.customShadows.z20},children:[e.jsx(Z,{children:x.severity==="success"?"Success":"Error"}),x.message]})}),e.jsx(G,{open:_,onClose:()=>!b&&f(!1),title:"Confirm Delete",content:"Are you sure you want to delete this expense?",action:e.jsx(p,{variant:"contained",color:"error",onClick:A,disabled:b,sx:{borderRadius:1.5,minWidth:100},children:b?"Deleting...":"Delete"})})]}):e.jsx(y,{children:e.jsxs(t,{sx:{py:20,textAlign:"center"},children:[e.jsx(a,{icon:"solar:ghost-bold",width:64,sx:{color:"text.disabled",mb:2}}),e.jsx(o,{variant:"h6",sx:{color:"text.secondary"},children:"Expense Not Found"}),e.jsx(p,{onClick:()=>i.push("/expenses"),sx:{mt:2},children:"Back to List"})]})})}function h({title:n,icon:i,noMargin:s=!1}){return e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:s?0:2.5},children:[e.jsx(a,{icon:i,width:20,sx:{color:"primary.main"}}),e.jsx(o,{variant:"subtitle1",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5},children:n})]})}function c({label:n,value:i,icon:s,color:j="text.primary",fullWidth:u}){return e.jsxs(t,{sx:u?{gridColumn:"1 / -1"}:{},children:[e.jsx(o,{variant:"caption",sx:{color:"text.disabled",fontWeight:700,textTransform:"uppercase",mb:.5,display:"block"},children:n}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(a,{icon:s,width:16,sx:{color:"text.disabled"}}),e.jsx(o,{variant:"body2",sx:{fontWeight:700,color:j},children:i||"-"})]})]})}function he(){const{id:n}=F();return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Expense Details - ${q.appName}`}),e.jsx(J,{id:n})]})}export{he as default};
