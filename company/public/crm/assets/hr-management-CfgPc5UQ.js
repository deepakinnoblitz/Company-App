import{f as n,H as i}from"./index-Co7v2xsC.js";import{h as s}from"./api-error-handler-CV6pRVHb.js";async function d(t,e){const a=e.filters||[];e.search&&e.searchField&&a.push([t,e.searchField,"like",`%${e.search}%`]);const o=e.orderBy&&e.order?`${e.orderBy} ${e.order}`:"creation desc",r=new URLSearchParams({doctype:t,fields:JSON.stringify(["*"]),filters:JSON.stringify(a),limit_start:String((e.page-1)*e.page_size),limit_page_length:String(e.page_size),order_by:o}),[c,p]=await Promise.all([n(`/api/method/frappe.client.get_list?${r.toString()}`),n(`/api/method/frappe.client.get_count?doctype=${t}&filters=${encodeURIComponent(JSON.stringify(a))}`)]);if(!c.ok){const y=await c.json();throw new Error(s(y,`Failed to fetch ${t}`))}const l=await c.json(),f=await p.json();return{data:l.message||[],total:f.message||0}}const w=t=>d("Employee",{...t,searchField:"employee_name"});async function u(t){const e=await i(),a=await n("/api/method/frappe.client.insert",{method:"POST",headers:e,body:JSON.stringify({doc:{doctype:"Employee",...t}})}),o=await a.json();if(!a.ok)throw new Error(s(o,"Failed to create employee"));return o.message}async function g(t,e){const a=await i(),o=await n("/api/method/frappe.client.set_value",{method:"POST",headers:a,body:JSON.stringify({doctype:"Employee",name:t,fieldname:e})}),r=await o.json();if(!o.ok)throw new Error(s(r,"Failed to update employee"));return r.message}async function j(t){const e=await i(),a=await n("/api/method/frappe.client.delete",{method:"POST",headers:e,body:JSON.stringify({doctype:"Employee",name:t})}),o=await a.json();if(!a.ok)throw new Error(s(o,"Failed to delete employee"));return!0}const S=t=>d("Attendance",{...t,searchField:"employee_name"});async function _(t){const e=await i(),a=await n("/api/method/frappe.client.insert",{method:"POST",headers:e,body:JSON.stringify({doc:{doctype:"Attendance",...t}})}),o=await a.json();if(!a.ok)throw new Error(s(o,"Failed to create attendance record"));return o.message}async function E(t,e){const a=await i(),o=await n("/api/method/frappe.client.set_value",{method:"POST",headers:a,body:JSON.stringify({doctype:"Attendance",name:t,fieldname:e})}),r=await o.json();if(!o.ok)throw new Error(s(r,"Failed to update attendance record"));return r.message}async function O(t){const e=await i(),a=await n("/api/method/frappe.client.delete",{method:"POST",headers:e,body:JSON.stringify({doctype:"Attendance",name:t})}),o=await a.json();if(!a.ok)throw new Error(s(o,"Failed to delete attendance record"));return!0}const F=t=>d("Leave Application",{...t,searchField:"employee_name"});async function k(t){const e=await i(),a=await n("/api/method/frappe.client.insert",{method:"POST",headers:e,body:JSON.stringify({doc:{doctype:"Leave Application",...t}})}),o=await a.json();if(!a.ok)throw new Error(s(o,"Failed to create leave application"));return o.message}async function A(t,e){const a=await i(),o=await n("/api/method/frappe.client.set_value",{method:"POST",headers:a,body:JSON.stringify({doctype:"Leave Application",name:t,fieldname:e})}),r=await o.json();if(!o.ok)throw new Error(s(r,"Failed to update leave application"));return r.message}async function v(t){const e=await i(),a=await n("/api/method/frappe.client.delete",{method:"POST",headers:e,body:JSON.stringify({doctype:"Leave Application",name:t})}),o=await a.json();if(!a.ok)throw new Error(s(o,"Failed to delete leave application"));return!0}async function $(t,e){const a=await n(`/api/method/frappe.client.get?doctype=${t}&name=${e}`);if(!a.ok){const o=await a.json();throw new Error(s(o,`Failed to fetch ${t} details`))}return(await a.json()).message}async function J(t){var o;const e=await n(`/api/method/frappe.desk.form.load.getdoctype?doctype=${t}`);if(!e.ok){const r=await e.json();throw new Error(s(r,`Failed to fetch metadata for ${t}`))}const a=await e.json();return((o=a.docs)==null?void 0:o[0])||a.message}async function N(){const t=await n(`/api/method/frappe.client.get_list?doctype=Salary Structure Component&fields=${JSON.stringify(["component_name","field_name","type","percentage","static_amount"])}&limit_page_length=100`),e=await t.json();if(!t.ok)throw new Error(s(e,"Failed to fetch salary components"));return e.message||[]}async function P(t){const e=await n(`/api/method/company.company.frontend_api.get_doc_permissions?doctype=${t}`);return e.ok?(await e.json()).message||{read:!1,write:!1,delete:!1}:{read:!1,write:!1,delete:!1}}export{P as a,J as b,N as c,j as d,u as e,w as f,$ as g,S as h,O as i,E as j,_ as k,F as l,A as m,k as n,v as o,g as u};
