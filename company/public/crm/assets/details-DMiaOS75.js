import{Z as L,W as O,r as n,j as e,$ as H,T as o,p as d,I as s,B as j,d as i,D as x,w as N}from"./index-Co7v2xsC.js";import"./format-time-9uMX-KY9.js";import"./dayjs.min-C2542nnJ.js";import"./invoice-collection-new-edit-form-B8bFSzvZ.js";import{c as m}from"./format-number-DSNgsWBE.js";import{g as M}from"./invoice-CmnDHtbD.js";import{D as y,C as U}from"./Card-CDV3jV6O.js";import{g as V,f as Z,d as q}from"./invoice-collection-BM_vtNuI.js";import{C as J}from"./confirm-dialog--19ddTk_.js";import{S as r}from"./Stack-GQIY7Xk9.js";import{S as K}from"./Snackbar-BVA3LOhi.js";import{A as Q}from"./AlertTitle-BbqQne_Q.js";import"./leads-d5FzXGcx.js";import"./api-error-handler-CV6pRVHb.js";import"./AdapterDayjs-BPhbSeWE.js";import"./index-Chjiymov.js";import"./useThemeProps-BDg4jra0.js";import"./useFormControl-Cqn8lfES.js";import"./Popper-DDlcgFVJ.js";import"./Select-B1EkSlUY.js";import"./visuallyHidden-Dan1xhjv.js";import"./TextField-BmVWmDzd.js";import"./DialogContent-DtP-sWqR.js";import"./DialogActions-h_2rRG3x.js";import"./Chip-Rg4Dn3a5.js";import"./Autocomplete-BIV6h0T7.js";import"./usePreviousProps-CVIlMhUg.js";import"./DatePicker-BMZY9CMK.js";import"./DialogTitle-C3eBZids.js";function X(){const{id:a}=L(),p=O(),[f,k]=n.useState(null),[R,T]=n.useState(!0),[g,v]=n.useState(!1),[w,_]=n.useState(!1),[A,b]=n.useState(!1),[C,F]=n.useState(null),[l,h]=n.useState({open:!1,message:"",severity:"success"});if(n.useEffect(()=>{a&&V(a).then(t=>{k(t),M(t.invoice).then(c=>{F(c)}).catch(c=>console.error("Failed to fetch invoice details",c)),Z({page:1,page_size:1,filters:{invoice:t.invoice}}).then(c=>{c.data.length>0&&_(c.data[0].name===t.name)})}).catch(t=>{console.error("Failed to fetch collection:",t),h({open:!0,message:"Failed to load collection details",severity:"error"})}).finally(()=>T(!1))},[a]),R)return e.jsx(y,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx(H,{})});if(!f)return e.jsxs(y,{children:[e.jsx(o,{variant:"h4",children:"Invoice Collection not found"}),e.jsx(d,{onClick:()=>p.push("/invoice-collections"),sx:{mt:3},children:"Go back to list"})]});const{invoice:P,customer:$,customer_name:B,company_name:I,collection_date:W,amount_to_pay:S,amount_collected:E,amount_pending:u,mode_of_payment:G,remarks:D}=f,z=async()=>{if(a)try{v(!0),await q(a),h({open:!0,message:"Collection deleted successfully",severity:"success"}),setTimeout(()=>p.push("/invoice-collections"),1500)}catch(t){console.error("Failed to delete collection:",t),h({open:!0,message:"Failed to delete collection",severity:"error"})}finally{v(!1),b(!1)}};return e.jsxs(y,{children:[e.jsxs(r,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsxs(o,{variant:"h4",children:["Invoice Collection: ",a]}),e.jsxs(r,{direction:"row",spacing:2,children:[e.jsx(d,{variant:"outlined",color:"inherit",onClick:()=>p.push("/invoice-collections"),startIcon:e.jsx(s,{icon:"solar:arrow-left-bold"}),children:"Back to List"}),w&&e.jsx(d,{variant:"contained",color:"error",onClick:()=>b(!0),startIcon:e.jsx(s,{icon:"solar:trash-bin-trash-bold"}),children:"Delete"}),w&&e.jsx(d,{variant:"contained",color:"primary",onClick:()=>p.push(`/invoice-collections/${encodeURIComponent(a||"")}/edit`),startIcon:e.jsx(s,{icon:"solar:pen-bold"}),children:"Edit Collection"})]})]}),e.jsx(U,{sx:{p:4,borderRadius:2},children:e.jsxs(r,{spacing:4,children:[e.jsxs(j,{sx:{display:"grid",columnGap:4,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:[e.jsxs(r,{spacing:1.5,children:[e.jsxs(r,{direction:"row",alignItems:"center",spacing:1,sx:{color:"text.secondary"},children:[e.jsx(s,{icon:"solar:document-text-bold-duotone",width:20}),e.jsx(o,{variant:"subtitle2",sx:{textTransform:"uppercase",letterSpacing:.5},children:"Invoice Details"})]}),e.jsxs(j,{sx:{p:2,borderRadius:1.5,bgcolor:t=>i(t.palette.grey[500],.04),border:t=>`1px solid ${i(t.palette.grey[500],.08)}`},children:[e.jsx(o,{variant:"caption",color:"text.disabled",children:"Invoice Number"}),e.jsx(o,{variant:"subtitle1",color:"primary.main",sx:{mt:.5},children:P}),C&&e.jsxs(e.Fragment,{children:[e.jsx(x,{sx:{my:1.5,borderStyle:"dashed"}}),e.jsx(o,{variant:"caption",color:"text.disabled",children:"Grand Total"}),e.jsx(o,{variant:"subtitle1",sx:{mt:.5},children:m(C.grand_total||0)})]}),e.jsx(x,{sx:{my:1.5,borderStyle:"dashed"}}),e.jsx(o,{variant:"caption",color:"text.disabled",children:"Amount to Pay"}),e.jsx(o,{variant:"h6",sx:{mt:.5},children:m(S)})]})]}),e.jsxs(r,{spacing:1.5,children:[e.jsxs(r,{direction:"row",alignItems:"center",spacing:1,sx:{color:"text.secondary"},children:[e.jsx(s,{icon:"solar:user-rounded-bold-duotone",width:20}),e.jsx(o,{variant:"subtitle2",sx:{textTransform:"uppercase",letterSpacing:.5},children:"Customer Details"})]}),e.jsxs(j,{sx:{p:2,borderRadius:1.5,bgcolor:t=>i(t.palette.grey[500],.04),border:t=>`1px solid ${i(t.palette.grey[500],.08)}`},children:[e.jsx(o,{variant:"caption",color:"text.disabled",children:"Customer ID"}),e.jsx(o,{variant:"subtitle2",sx:{mt:.5},children:$}),e.jsx(x,{sx:{my:1.5,borderStyle:"dashed"}}),e.jsx(o,{variant:"caption",color:"text.disabled",children:"Name"}),e.jsx(o,{variant:"body2",sx:{mt:.5},children:B||"-"}),I&&e.jsxs(e.Fragment,{children:[e.jsx(x,{sx:{my:1.5,borderStyle:"dashed"}}),e.jsx(o,{variant:"caption",color:"text.disabled",children:"Company"}),e.jsx(o,{variant:"body2",sx:{mt:.5},children:I})]})]})]}),e.jsxs(r,{spacing:1.5,children:[e.jsxs(r,{direction:"row",alignItems:"center",spacing:1,sx:{color:"text.secondary"},children:[e.jsx(s,{icon:"solar:calendar-bold-duotone",width:20}),e.jsx(o,{variant:"subtitle2",sx:{textTransform:"uppercase",letterSpacing:.5},children:"Collection Info"})]}),e.jsxs(r,{spacing:2,sx:{p:2,borderRadius:1.5,bgcolor:t=>i(t.palette.grey[500],.04),border:t=>`1px solid ${i(t.palette.grey[500],.08)}`},children:[e.jsxs(r,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{variant:"caption",color:"text.disabled",children:"Collection Date"}),e.jsx(o,{variant:"body2",sx:{fontWeight:"fontWeightSemiBold"},children:W})]}),e.jsxs(r,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{variant:"caption",color:"text.disabled",children:"Payment Mode"}),e.jsx(o,{variant:"body2",sx:{fontWeight:"fontWeightSemiBold"},children:G})]})]})]})]}),e.jsxs(j,{children:[e.jsxs(r,{direction:"row",alignItems:"center",spacing:1,sx:{mb:2,color:"text.secondary"},children:[e.jsx(s,{icon:"solar:wad-of-money-bold-duotone",width:20}),e.jsx(o,{variant:"subtitle2",sx:{textTransform:"uppercase",letterSpacing:.5},children:"Payment Summary"})]}),e.jsxs(r,{spacing:2,sx:{p:3,borderRadius:2,bgcolor:t=>i(t.palette.grey[500],.04),border:t=>`1px solid ${i(t.palette.grey[500],.08)}`},children:[e.jsxs(r,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Amount to Pay"}),e.jsx(o,{variant:"subtitle2",children:m(S)})]}),e.jsxs(r,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(r,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(s,{icon:"solar:hand-money-bold-duotone",width:16,sx:{color:"success.main"}}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Amount Collected"})]}),e.jsx(o,{variant:"subtitle2",color:"success.main",children:m(E)})]}),e.jsx(x,{sx:{borderStyle:"dashed"}}),e.jsxs(r,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(r,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(s,{icon:"solar:wallet-2-bold-duotone",width:20,sx:{color:(u||0)>0?"error.main":"success.main"}}),e.jsx(o,{variant:"subtitle1",sx:{color:(u||0)>0?"error.main":"success.main"},children:"Amount Pending"})]}),e.jsx(o,{variant:"h5",color:(u||0)>0?"error.main":"success.main",children:m(u)})]})]})]}),D&&e.jsxs(r,{spacing:1,children:[e.jsxs(r,{direction:"row",alignItems:"center",spacing:1,sx:{color:"text.secondary"},children:[e.jsx(s,{icon:"solar:notes-bold-duotone",width:20}),e.jsx(o,{variant:"subtitle2",sx:{textTransform:"uppercase",letterSpacing:.5},children:"Remarks"})]}),e.jsx(o,{variant:"body2",sx:{p:2,borderRadius:1.5,bgcolor:t=>i(t.palette.primary.main,.04),border:t=>`1px solid ${i(t.palette.primary.main,.12)}`,whiteSpace:"pre-wrap",minHeight:80,color:"text.secondary"},children:D})]})]})}),e.jsx(K,{open:l.open,autoHideDuration:6e3,onClose:()=>h({...l,open:!1}),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(N,{severity:l.severity,sx:{width:"100%",boxShadow:t=>t.customShadows.z20},children:[e.jsx(Q,{children:l.severity==="success"?"Success":"Error"}),l.message]})}),e.jsx(J,{open:A,onClose:()=>!g&&b(!1),title:"Confirm Delete",content:"Are you sure you want to delete this invoice collection?",action:e.jsx(d,{variant:"contained",color:"error",onClick:z,disabled:g,sx:{borderRadius:1.5,minWidth:100},children:g?"Deleting...":"Delete"})})]})}function Re(){return e.jsx(X,{})}export{Re as default};
