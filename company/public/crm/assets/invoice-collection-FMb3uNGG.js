import{r,j as e,T as c,p as P,I as h,B as p,S as G,h as $,d as v}from"./index-Co7v2xsC.js";import{C as H}from"./config-global-BX9xwJzv.js";import{d as M}from"./dayjs.min-C2542nnJ.js";import{r as O,u as _,w as V}from"./reports-0l1D3gVE.js";import{c as C}from"./format-number-DSNgsWBE.js";import{D as q,C as W}from"./Card-CDV3jV6O.js";import{S as m}from"./Stack-GQIY7Xk9.js";import{T as F}from"./TextField-BmVWmDzd.js";import{L as J,A as K}from"./AdapterDayjs-BPhbSeWE.js";import{D as L}from"./DatePicker-BMZY9CMK.js";import{T as Q,a as U,b as X,c as T,d as o,e as Z}from"./TableRow-DqeBPnxy.js";import{T as ee}from"./TablePagination-CEaYVDlQ.js";import"./api-error-handler-CV6pRVHb.js";import"./Select-B1EkSlUY.js";import"./useFormControl-Cqn8lfES.js";import"./index-Chjiymov.js";import"./useThemeProps-BDg4jra0.js";import"./Popper-DDlcgFVJ.js";import"./visuallyHidden-Dan1xhjv.js";import"./DialogContent-DtP-sWqR.js";import"./DialogActions-h_2rRG3x.js";import"./Chip-Rg4Dn3a5.js";import"./KeyboardArrowRight-CBVMFcL2.js";import"./LastPage-CUGiC0iB.js";function te(){const[s,i]=r.useState([]),[u,I]=r.useState([]),[l,d]=r.useState(!1),[n,x]=r.useState(""),[g,R]=r.useState(""),[f,Y]=r.useState(null),[j,k]=r.useState(null),[S,w]=r.useState(0),[b,z]=r.useState(10),D=r.useCallback(async()=>{d(!0);try{const t={};n&&(t.customer=n),g&&(t.invoice=g),f&&(t.from_date=f.format("YYYY-MM-DD")),j&&(t.to_date=j.format("YYYY-MM-DD"));const a=await O("Invoice & Collection Summary",t);i(a.result||[]),I(a.report_summary||[]),w(0)}catch(t){console.error("Failed to fetch invoice collection report:",t)}finally{d(!1)}},[n,g,f,j]);r.useEffect(()=>{D()},[D]);const N=()=>{x(""),R(""),Y(null),k(null)},A=r.useCallback((t,a)=>{w(a)},[]),E=r.useCallback(t=>{z(parseInt(t.target.value,10)),w(0)},[]),B=()=>{const t=_.json_to_sheet(s),a=_.book_new();_.book_append_sheet(a,t,"Invoice Collections"),V(a,"Invoice_Collection_Report.xlsx")};return e.jsx(q,{children:e.jsxs(m,{spacing:3,children:[e.jsxs(m,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(c,{variant:"h4",children:"Invoice Collection Summary"}),e.jsxs(m,{direction:"row",spacing:1,children:[e.jsx(P,{variant:"outlined",startIcon:e.jsx(h,{icon:"solar:refresh-bold"}),onClick:D,disabled:l,children:"Refresh"}),e.jsx(P,{variant:"outlined",color:"error",startIcon:e.jsx(h,{icon:"solar:restart-bold"}),onClick:N,children:"Reset"})]})]}),e.jsxs(W,{sx:{p:2.5,display:"flex",gap:2,flexWrap:"wrap",alignItems:"center",bgcolor:"background.neutral",border:t=>`1px solid ${t.palette.divider}`},children:[e.jsx(F,{label:"Customer",value:n,onChange:t=>x(t.target.value),placeholder:"Search customer...",size:"small",sx:{minWidth:200}}),e.jsx(F,{label:"Invoice No",value:g,onChange:t=>R(t.target.value),placeholder:"Search invoice...",size:"small",sx:{minWidth:150}}),e.jsxs(J,{dateAdapter:K,children:[e.jsx(L,{label:"From Date",value:f,onChange:t=>Y(t),slotProps:{textField:{size:"small"}}}),e.jsx(L,{label:"To Date",value:j,onChange:t=>k(t),slotProps:{textField:{size:"small"}}})]}),e.jsx(p,{sx:{flexGrow:1}}),e.jsx(P,{variant:"contained",startIcon:e.jsx(h,{icon:"solar:export-bold"}),onClick:B,disabled:s.length===0,children:"Export"})]}),e.jsxs(p,{sx:{display:"grid",gap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:[u.map((t,a)=>e.jsx(y,{item:t},a)),u.length===0&&e.jsxs(e.Fragment,{children:[e.jsx(y,{item:{label:"Total Invoices",value:0,indicator:"blue"}}),e.jsx(y,{item:{label:"Collected Amount",value:0,indicator:"green",datatype:"Currency"}}),e.jsx(y,{item:{label:"Pending Amount",value:0,indicator:"red",datatype:"Currency"}})]})]}),e.jsxs(W,{children:[e.jsx(Q,{sx:{position:"relative",overflow:"unset"},children:e.jsx(G,{children:e.jsxs(U,{size:"medium",stickyHeader:!0,children:[e.jsx(X,{children:e.jsxs(T,{sx:{bgcolor:"#f4f6f8"},children:[e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Invoice"}),e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Date"}),e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Customer"}),e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Grand Total"}),e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Collected"}),e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Pending"}),e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Last Collection"}),e.jsx(o,{sx:{fontWeight:700,color:"text.secondary"},children:"Mode"})]})}),e.jsxs(Z,{children:[s.slice(S*b,S*b+b).map((t,a)=>e.jsxs(T,{hover:!0,children:[e.jsx(o,{sx:{fontWeight:600},children:t.invoice}),e.jsx(o,{children:t.invoice_date?M(t.invoice_date).format("DD MMM YYYY"):"-"}),e.jsxs(o,{children:[e.jsx(c,{variant:"body2",sx:{fontWeight:600},children:t.customer_name}),e.jsx(c,{variant:"caption",sx:{color:"text.secondary"},children:t.customer})]}),e.jsx(o,{sx:{fontWeight:600},children:C(t.grand_total)}),e.jsx(o,{sx:{color:"success.main",fontWeight:600},children:C(t.amount_collected)}),e.jsx(o,{sx:{color:"error.main",fontWeight:600},children:C(t.amount_pending)}),e.jsx(o,{children:t.last_collection_date?M(t.last_collection_date).format("DD MMM YYYY"):"-"}),e.jsx(o,{children:t.payment_mode||"-"})]},a)),s.length===0&&!l&&e.jsx(T,{children:e.jsx(o,{colSpan:8,align:"center",sx:{py:10},children:e.jsxs(m,{spacing:1,alignItems:"center",children:[e.jsx(h,{icon:"eva:slash-outline",width:48,sx:{color:"text.disabled"}}),e.jsx(c,{variant:"body2",sx:{color:"text.disabled"},children:"No data found"})]})})})]})]})})}),e.jsx(ee,{component:"div",count:s.length,page:S,onPageChange:A,rowsPerPage:b,onRowsPerPageChange:E,rowsPerPageOptions:[5,10,25]})]})]})})}function y({item:s}){var d;const i=$(),u=n=>{switch(n==null?void 0:n.toLowerCase()){case"blue":return i.palette.info.main;case"green":return i.palette.success.main;case"orange":return i.palette.warning.main;case"red":return i.palette.error.main;default:return i.palette.primary.main}},I=n=>{const x=n.toLowerCase();return x.includes("collected")?"solar:wallet-money-bold-duotone":x.includes("pending")?"solar:card-search-bold-duotone":"solar:bill-list-bold-duotone"},l=u(s.indicator);return e.jsxs(W,{sx:{p:3,boxShadow:"none",position:"relative",overflow:"hidden",bgcolor:v(l,.04),border:`1px solid ${v(l,.1)}`,transition:i.transitions.create(["transform","box-shadow"]),"&:hover":{transform:"translateY(-4px)",boxShadow:`0 12px 24px -4px ${v(l,.12)}`}},children:[e.jsxs(m,{direction:"row",alignItems:"center",spacing:2.5,children:[e.jsx(p,{sx:{width:48,height:48,flexShrink:0,display:"flex",borderRadius:1.5,alignItems:"center",justifyContent:"center",color:l,bgcolor:v(l,.1)},children:e.jsx(h,{icon:I(s.label),width:28})}),e.jsxs(p,{sx:{flexGrow:1},children:[e.jsx(c,{variant:"subtitle2",sx:{color:"text.secondary",fontWeight:700,mb:.5},children:s.label}),e.jsx(c,{variant:"h4",sx:{color:"text.primary",fontWeight:800},children:s.datatype==="Currency"?C(s.value):(d=s.value)==null?void 0:d.toLocaleString()})]})]}),e.jsx(p,{sx:{top:-16,right:-16,width:80,height:80,opacity:.08,position:"absolute",borderRadius:"50%",bgcolor:l}})]})}function De(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Invoice Collection Report - ${H.appName}`}),e.jsx(te,{})]})}export{De as default};
