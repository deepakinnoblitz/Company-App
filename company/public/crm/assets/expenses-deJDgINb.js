import{f as o,H as r}from"./index-Co7v2xsC.js";import{h as p}from"./api-error-handler-CV6pRVHb.js";async function y(e){const t=[];e.search&&t.push([["Expenses","expense_category","like",`%${e.search}%`]]),e.filters&&(e.filters.expense_id&&t.push(["Expenses","expense_no","like",`%${e.filters.expense_id}%`]),e.filters.expense_category&&e.filters.expense_category!=="all"&&t.push(["Expenses","expense_category","like",`%${e.filters.expense_category}%`]),e.filters.payment_type&&e.filters.payment_type!=="all"&&t.push(["Expenses","payment_type","=",e.filters.payment_type]),e.filters.start_date&&t.push(["Expenses","date",">=",e.filters.start_date]),e.filters.end_date&&t.push(["Expenses","date","<=",e.filters.end_date]));let s="date desc";if(e.sort_by){const a=e.sort_by.split("_"),l=a[a.length-1];s=`${a.slice(0,-1).join("_")} ${l}`}const n=new URLSearchParams({doctype:"Expenses",fields:JSON.stringify(["name","expense_no","expense_category","date","payment_type","total","description","owner","creation"]),filters:JSON.stringify(t),limit_start:String((e.page-1)*e.page_size),limit_page_length:String(e.page_size),order_by:s}),[i,c]=await Promise.all([o(`/api/method/frappe.client.get_list?${n.toString()}`),o(`/api/method/frappe.client.get_count?doctype=Expenses&filters=${encodeURIComponent(JSON.stringify(t))}`)]);if(!i.ok)throw new Error("Failed to fetch expenses");const f=await i.json(),d=await c.json();return{data:f.message||[],total:d.message||0}}const x=e=>y(e);async function u(e){const t=await r(),s=await o("/api/method/frappe.client.insert",{method:"POST",headers:t,body:JSON.stringify({doc:{doctype:"Expenses",...e}})}),n=await s.json();if(!s.ok)throw new Error(p(n,"Failed to create expense"));return n.message}async function w(e,t){const s=await r(),n=await o("/api/method/frappe.client.set_value",{method:"POST",headers:s,body:JSON.stringify({doctype:"Expenses",name:e,fieldname:t})}),i=await n.json();if(!n.ok)throw new Error(p(i,"Failed to update expense"));return i.message}async function E(e){const t=await r(),s=await o("/api/method/frappe.client.delete",{method:"POST",headers:t,body:JSON.stringify({doctype:"Expenses",name:e})}),n=await s.json();if(!s.ok)throw new Error(p(n,"Failed to delete expense"));return n.message}async function m(e){const t=await o(`/api/method/frappe.client.get?doctype=Expenses&name=${e}`);if(!t.ok)throw new Error("Failed to fetch expense details");return(await t.json()).message}async function S(e,t){const s={doctype:e};t&&(s.fields=JSON.stringify(t));const n=new URLSearchParams(s),i=await o(`/api/method/company.company.frontend_api.get_doctype_list?${n.toString()}`);return i.ok?(await i.json()).message||[]:[]}export{S as a,u as c,E as d,x as f,m as g,w as u};
