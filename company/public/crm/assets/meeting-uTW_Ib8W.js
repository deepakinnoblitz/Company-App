import{r as s,j as e,T as d,v as se,I as f,B as o,D as Z,p as z,q as b,S as Se,h as we,d as T}from"./index-Co7v2xsC.js";import{C as Ce}from"./config-global-BX9xwJzv.js";import{d as ke}from"./dayjs.min-C2542nnJ.js";import{r as De,u as F,w as _e}from"./reports-0l1D3gVE.js";import{getDoctypeList as Me}from"./leads-d5FzXGcx.js";import{D as Re,C as V}from"./Card-CDV3jV6O.js";import{E as Ie}from"./export-fields-dialog-DKDJ10Kv.js";import{g as We}from"./meetings-CH-Mye0X.js";import{L as Te}from"./label-BpZ9ieER.js";import"./styles-wAmuuHpw.js";import{D as Fe,a as Oe}from"./DialogContent-DtP-sWqR.js";import{D as Pe}from"./DialogTitle-C3eBZids.js";import{S as D}from"./Stack-GQIY7Xk9.js";import{L as Ee,A as Le}from"./AdapterDayjs-BPhbSeWE.js";import{D as ee}from"./DatePicker-BMZY9CMK.js";import{F as O,S as P}from"./Select-B1EkSlUY.js";import{T as Ae,a as Ye,b as ze,c as N,d as l,e as Ne}from"./TableRow-DqeBPnxy.js";import{C as te}from"./Checkbox-CoJXcvzD.js";import{T as Be}from"./TablePagination-CEaYVDlQ.js";import"./api-error-handler-CV6pRVHb.js";import"./RadioGroup-B7r1ll7C.js";import"./useFormControl-Cqn8lfES.js";import"./FormControlLabel-CEvUm0a3.js";import"./DialogActions-h_2rRG3x.js";import"./utils-CQVN1UoU.js";import"./index-Chjiymov.js";import"./useThemeProps-BDg4jra0.js";import"./Popper-DDlcgFVJ.js";import"./visuallyHidden-Dan1xhjv.js";import"./TextField-BmVWmDzd.js";import"./Chip-Rg4Dn3a5.js";import"./KeyboardArrowRight-CBVMFcL2.js";import"./LastPage-CUGiC0iB.js";function Ve({open:n,onClose:i,meetingId:g}){const[r,x]=s.useState(null),[j,h]=s.useState(!1);s.useEffect(()=>{n&&g?(h(!0),We(g).then(u=>{x(u),h(!1)}).catch(u=>{console.error(u),h(!1)})):x(null)},[n,g]);const v=u=>{switch(u){case"Completed":return"success";case"Scheduled":return"info";case"Overdue":return"error";case"Cancelled":return"warning";default:return"default"}};return e.jsxs(Fe,{open:n,onClose:i,fullWidth:!0,maxWidth:"md",children:[e.jsxs(Pe,{sx:{m:0,p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:"background.neutral"},children:[e.jsx(d,{variant:"h6",sx:{fontWeight:800},children:"Meeting Details"}),e.jsx(se,{onClick:i,sx:{color:u=>u.palette.grey[500],bgcolor:"background.paper",boxShadow:u=>{var C;return(C=u.customShadows)==null?void 0:C.z1}},children:e.jsx(f,{icon:"mingcute:close-line"})})]}),e.jsx(Oe,{sx:{p:4,m:2,mt:4},children:j?e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:10},children:e.jsx(f,{icon:"svg-spinners:12-dots-scale-rotate",width:40,sx:{color:"primary.main"}})}):r?e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:5},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:2.5},children:[e.jsx(o,{sx:{width:64,height:64,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.lighter",color:"primary.main"},children:e.jsx(f,{icon:"solar:calendar-date-bold",width:32})}),e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(d,{variant:"h5",sx:{fontWeight:800},children:r.title}),e.jsxs(d,{variant:"body2",sx:{color:"text.secondary",fontWeight:600},children:[r.meet_for," with ",r.lead_name]})]}),e.jsxs(o,{sx:{textAlign:"right"},children:[e.jsx(Te,{variant:"soft",color:v(r.outgoing_call_status),children:r.outgoing_call_status}),e.jsxs(d,{variant:"caption",sx:{display:"block",mt:1,color:"text.disabled",fontWeight:700},children:["ID: ",r.name]})]})]}),e.jsx(Z,{sx:{borderStyle:"dashed"}}),e.jsxs(o,{children:[e.jsx(B,{title:"Meeting Information",icon:"solar:info-circle-bold"}),e.jsxs(o,{sx:{display:"grid",gap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:[e.jsx(y,{label:"Subject",value:r.title,icon:"solar:pen-bold",fullWidth:!0}),e.jsx(y,{label:"Meet For",value:r.meet_for,icon:"solar:user-bold"}),e.jsx(y,{label:"Reference",value:r.lead_name,icon:"solar:link-bold"}),e.jsx(y,{label:"From",value:r.from?new Date(r.from).toLocaleString():"-",icon:"solar:clock-circle-bold"}),e.jsx(y,{label:"To",value:r.to?new Date(r.to).toLocaleString():"-",icon:"solar:clock-circle-bold"}),e.jsx(y,{label:"Venue",value:r.meeting_venue,icon:"solar:buildings-bold"}),e.jsx(y,{label:"Location",value:r.location,icon:"solar:map-point-bold"}),e.jsx(y,{label:"Owner",value:r.owner,icon:"solar:user-rounded-bold"})]})]}),e.jsx(Z,{sx:{borderStyle:"dashed"}}),e.jsxs(o,{children:[e.jsx(B,{title:"Meeting Notes",icon:"solar:notebook-bold"}),e.jsx(o,{sx:{p:2,bgcolor:"background.neutral",borderRadius:1.5},children:e.jsx(d,{variant:"body2",sx:{whiteSpace:"pre-wrap",color:"text.primary",fontWeight:500},children:r.completed_meet_notes||"No notes available."})})]}),e.jsxs(o,{sx:{p:3,bgcolor:"background.neutral",borderRadius:2},children:[e.jsx(B,{title:"System Information",icon:"solar:clock-circle-bold",noMargin:!0}),e.jsxs(o,{sx:{mt:3,display:"grid",gap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(y,{label:"Created On",value:new Date(r.creation).toLocaleString(),icon:"solar:calendar-date-bold"}),e.jsx(y,{label:"Modified On",value:new Date(r.modified).toLocaleString(),icon:"solar:calendar-minimalistic-bold"})]})]})]}):e.jsxs(o,{sx:{py:10,textAlign:"center"},children:[e.jsx(f,{icon:"solar:ghost-bold",width:64,sx:{color:"text.disabled",mb:2}}),e.jsx(d,{variant:"h6",sx:{color:"text.secondary"},children:"No Details Found"})]})})]})}function B({title:n,icon:i,noMargin:g=!1}){return e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,mb:g?0:2.5},children:[e.jsx(f,{icon:i,width:20,sx:{color:"primary.main"}}),e.jsx(d,{variant:"subtitle1",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5},children:n})]})}function y({label:n,value:i,icon:g,color:r="text.primary",fullWidth:x}){return e.jsxs(o,{sx:x?{gridColumn:"1 / -1"}:{},children:[e.jsx(d,{variant:"caption",sx:{color:"text.disabled",fontWeight:700,textTransform:"uppercase",mb:.5,display:"block"},children:n}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(f,{icon:g,width:16,sx:{color:"text.disabled"}}),e.jsx(d,{variant:"body2",sx:{fontWeight:700,color:r},children:i||"-"})]})]})}function He(){const[n,i]=s.useState([]),[g,r]=s.useState([]),[x,j]=s.useState(!1),[h,v]=s.useState(null),[u,C]=s.useState(null),[_,H]=s.useState("all"),[M,$]=s.useState("all"),[R,G]=s.useState("all"),[I,U]=s.useState("all"),[re,ne]=s.useState([]),[oe]=s.useState(["Scheduled","Completed","Overdue","Cancelled"]),[le]=s.useState(["Lead","Contact","Prospect","Customer"]),[E,L]=s.useState(0),[W,ae]=s.useState(10),[ie,q]=s.useState(!1),[ce,J]=s.useState(null),[m,A]=s.useState([]),de=t=>{if(t.target.checked){const c=n.map(a=>a.name);A(c);return}A([])},xe=(t,c)=>{const a=m.indexOf(c);let p=[];a===-1?p=p.concat(m,c):a===0?p=p.concat(m.slice(1)):a===m.length-1?p=p.concat(m.slice(0,-1)):a>0&&(p=p.concat(m.slice(0,a),m.slice(a+1))),A(p)},[he,K]=s.useState(!1),ue=async(t,c)=>{j(!0);try{const a=m.length>0?m:n.map(S=>S.name);if(a.length===0){j(!1);return}const p=[["Meeting","name","in",a]],je=new URLSearchParams({doctype:"Meeting",fields:JSON.stringify(t),filters:JSON.stringify(p),limit_page_length:"99999"}),Q=await fetch(`/api/method/frappe.client.get_list?${je.toString()}`,{credentials:"include"});if(!Q.ok)throw new Error("Failed to fetch data for export");const be=(await Q.json()).message||[],X=F.json_to_sheet(be);if(c==="excel"){const S=F.book_new();F.book_append_sheet(S,X,"Meetings"),_e(S,"Meeting_Report.xlsx")}else{const S=F.sheet_to_csv(X),ye=new Blob([S],{type:"text/csv;charset=utf-8;"}),w=document.createElement("a"),ve=URL.createObjectURL(ye);w.setAttribute("href",ve),w.setAttribute("download","Meeting_Report.csv"),w.style.visibility="hidden",document.body.appendChild(w),w.click(),document.body.removeChild(w)}}catch(a){console.error(a)}finally{j(!1)}},me=s.useCallback(t=>{J(t),q(!0)},[]),pe=s.useCallback((t,c)=>{L(c)},[]),ge=s.useCallback(t=>{ae(parseInt(t.target.value,10)),L(0)},[]),Y=s.useCallback(async()=>{j(!0);try{const t={};h&&(t.from_date=h.format("YYYY-MM-DD")),u&&(t.to_date=u.format("YYYY-MM-DD")),_!=="all"&&(t.meet_for=_),M!=="all"&&(t.status=M),R!=="all"&&(t.owner=R),I!=="all"&&(t.enable_reminder=I);const c=await De("Meeting Report",t);i(c.result||[]),r(c.report_summary||[]),L(0)}catch(t){console.error("Failed to fetch meeting report:",t)}finally{j(!1)}},[h,u,_,M,R,I]);s.useEffect(()=>{Y()},[Y]);const fe=()=>{v(null),C(null),H("all"),$("all"),G("all"),U("all")};return s.useEffect(()=>{Me("User").then(ne)},[]),e.jsxs(Re,{children:[e.jsxs(D,{spacing:3,children:[e.jsxs(D,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(d,{variant:"h4",children:"Meeting Report"}),e.jsxs(D,{direction:"row",spacing:1,children:[e.jsx(z,{variant:"outlined",startIcon:e.jsx(f,{icon:"solar:refresh-bold"}),onClick:Y,disabled:x,children:"Refresh"}),e.jsx(z,{variant:"outlined",color:"error",startIcon:e.jsx(f,{icon:"solar:restart-bold"}),onClick:fe,children:"Reset"})]})]}),e.jsxs(V,{sx:{p:2.5,display:"flex",gap:2,flexWrap:"wrap",alignItems:"center",bgcolor:"background.neutral",border:t=>`1px solid ${t.palette.divider}`},children:[e.jsxs(Ee,{dateAdapter:Le,children:[e.jsx(ee,{label:"From Date",value:h,onChange:t=>v(t),slotProps:{textField:{size:"small"}}}),e.jsx(ee,{label:"To Date",value:u,onChange:t=>C(t),slotProps:{textField:{size:"small"}}})]}),e.jsx(O,{size:"small",sx:{minWidth:160},children:e.jsxs(P,{value:_,onChange:t=>H(t.target.value),displayEmpty:!0,children:[e.jsx(b,{value:"all",children:"Meet For"}),le.map(t=>e.jsx(b,{value:t,children:t},t))]})}),e.jsx(O,{size:"small",sx:{minWidth:160},children:e.jsxs(P,{value:M,onChange:t=>$(t.target.value),displayEmpty:!0,children:[e.jsx(b,{value:"all",children:"Status"}),oe.map(t=>e.jsx(b,{value:t,children:t},t))]})}),e.jsx(O,{size:"small",sx:{minWidth:160},children:e.jsxs(P,{value:R,onChange:t=>G(t.target.value),displayEmpty:!0,children:[e.jsx(b,{value:"all",children:"Owner"}),e.jsx(b,{value:"Administrator",children:"Administrator"}),re.filter(t=>t!=="Administrator").map(t=>e.jsx(b,{value:t,children:t},t))]})}),e.jsx(O,{size:"small",sx:{minWidth:160},children:e.jsxs(P,{value:I,onChange:t=>U(t.target.value),displayEmpty:!0,children:[e.jsx(b,{value:"all",children:"Reminder"}),e.jsx(b,{value:"1",children:"Enabled"}),e.jsx(b,{value:"0",children:"Disabled"})]})}),e.jsx(o,{sx:{flexGrow:1}}),e.jsx(z,{variant:"contained",startIcon:e.jsx(f,{icon:"solar:export-bold"}),onClick:()=>K(!0),children:"Export"})]}),e.jsxs(o,{sx:{display:"grid",gap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(4, 1fr)"}},children:[g.map((t,c)=>e.jsx(k,{item:t},c)),g.length===0&&e.jsxs(e.Fragment,{children:[e.jsx(k,{item:{label:"Total Meetings",value:0,indicator:"blue"}}),e.jsx(k,{item:{label:"Scheduled",value:0,indicator:"orange"}}),e.jsx(k,{item:{label:"Completed",value:0,indicator:"green"}}),e.jsx(k,{item:{label:"With Reminder",value:0,indicator:"red"}})]})]}),e.jsxs(V,{children:[e.jsx(Ae,{sx:{position:"relative",overflow:"unset"},children:e.jsx(Se,{children:e.jsxs(Ye,{size:"medium",stickyHeader:!0,children:[e.jsx(ze,{children:e.jsxs(N,{sx:{bgcolor:"#f4f6f8"},children:[e.jsx(l,{padding:"checkbox",children:e.jsx(te,{indeterminate:m.length>0&&m.length<n.length,checked:n.length>0&&m.length===n.length,onChange:de})}),e.jsx(l,{sx:{fontWeight:700,color:"text.secondary"},children:"Title"}),e.jsx(l,{sx:{fontWeight:700,color:"text.secondary"},children:"Meet For"}),e.jsx(l,{sx:{fontWeight:700,color:"text.secondary"},children:"Lead/Contact"}),e.jsx(l,{sx:{fontWeight:700,color:"text.secondary"},children:"Account"}),e.jsx(l,{sx:{fontWeight:700,color:"text.secondary"},children:"Status"}),e.jsx(l,{sx:{fontWeight:700,color:"text.secondary"},children:"Time & Venue"}),e.jsx(l,{sx:{fontWeight:700,color:"text.secondary"},children:"Owner"}),e.jsx(l,{align:"right",sx:{fontWeight:700,color:"text.secondary",position:"sticky",right:0,bgcolor:"#f4f6f8",zIndex:11},children:"Actions"})]})}),e.jsxs(Ne,{children:[n.slice(E*W,E*W+W).map((t,c)=>{const a=m.indexOf(t.name)!==-1;return e.jsxs(N,{hover:!0,role:"checkbox","aria-checked":a,selected:a,children:[e.jsx(l,{padding:"checkbox",children:e.jsx(te,{checked:a,onClick:p=>xe(p,t.name)})}),e.jsx(l,{sx:{fontWeight:600},children:t.title}),e.jsx(l,{children:t.meet_for}),e.jsx(l,{children:t.lead_name||t.contact_name||"-"}),e.jsx(l,{children:t.account_name||"-"}),e.jsx(l,{children:t.outgoing_call_status}),e.jsxs(l,{children:[e.jsx(d,{variant:"body2",sx:{fontWeight:600},children:t.from_time?ke(t.from_time).format("DD MMM YYYY HH:mm"):"-"}),e.jsx(d,{variant:"caption",sx:{color:"text.secondary"},children:t.meeting_venue||t.location||"-"})]}),e.jsx(l,{children:t.owner_name}),e.jsx(l,{align:"right",sx:{position:"sticky",right:0,bgcolor:"background.paper",boxShadow:"-2px 0 4px rgba(145, 158, 171, 0.08)"},children:e.jsx(se,{onClick:()=>me(t.name),sx:{color:"info.main"},children:e.jsx(f,{icon:"solar:eye-bold"})})})]},c)}),n.length===0&&!x&&e.jsx(N,{children:e.jsx(l,{colSpan:9,align:"center",sx:{py:10},children:e.jsxs(D,{spacing:1,alignItems:"center",children:[e.jsx(f,{icon:"eva:slash-outline",width:48,sx:{color:"text.disabled"}}),e.jsx(d,{variant:"body2",sx:{color:"text.disabled"},children:"No data found"})]})})})]})]})})}),e.jsx(Be,{component:"div",count:n.length,page:E,onPageChange:pe,rowsPerPage:W,onRowsPerPageChange:ge,rowsPerPageOptions:[5,10,25]})]})]}),e.jsx(Ve,{open:ie,meetingId:ce,onClose:()=>{q(!1),J(null)}}),e.jsx(Ie,{open:he,onClose:()=>K(!1),doctype:"Meeting",onExport:ue})]})}function k({item:n}){var j;const i=we(),g=h=>{switch(h==null?void 0:h.toLowerCase()){case"blue":return i.palette.info.main;case"green":return i.palette.success.main;case"orange":return i.palette.warning.main;case"red":return i.palette.error.main;default:return i.palette.primary.main}},r=h=>{const v=h.toLowerCase();return v.includes("meeting")?"solar:videocamera-record-bold-duotone":v.includes("scheduled")?"solar:calendar-mark-bold-duotone":v.includes("completed")?"solar:check-circle-bold-duotone":v.includes("reminder")?"solar:bell-bing-bold-duotone":"solar:chart-2-bold-duotone"},x=g(n.indicator);return e.jsxs(V,{sx:{p:3,boxShadow:"none",position:"relative",overflow:"hidden",bgcolor:T(x,.04),border:`1px solid ${T(x,.1)}`,transition:i.transitions.create(["transform","box-shadow"]),"&:hover":{transform:"translateY(-4px)",boxShadow:`0 12px 24px -4px ${T(x,.12)}`}},children:[e.jsxs(D,{direction:"row",alignItems:"center",spacing:2.5,children:[e.jsx(o,{sx:{width:48,height:48,flexShrink:0,display:"flex",borderRadius:1.5,alignItems:"center",justifyContent:"center",color:x,bgcolor:T(x,.1)},children:e.jsx(f,{icon:r(n.label),width:28})}),e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(d,{variant:"subtitle2",sx:{color:"text.secondary",fontWeight:700,mb:.5},children:n.label}),e.jsx(d,{variant:"h4",sx:{color:"text.primary",fontWeight:800},children:(j=n.value)==null?void 0:j.toLocaleString()})]})]}),e.jsx(o,{sx:{top:-16,right:-16,width:80,height:80,opacity:.08,position:"absolute",borderRadius:"50%",bgcolor:x}})]})}function Ct(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Meeting Report - ${Ce.appName}`}),e.jsx(He,{})]})}export{Ct as default};
