import{r as l,j as e,B as c,T as x,v as F,I as Y,q as i,p as O,w as $}from"./index-Co7v2xsC.js";import{d as T}from"./dayjs.min-C2542nnJ.js";import{s as H}from"./string-DcbcEmw6.js";import{getDoctypeList as _}from"./leads-d5FzXGcx.js";import{u as B,c as N}from"./meetings-CH-Mye0X.js";import{D as G,a as R}from"./DialogContent-DtP-sWqR.js";import{D as M}from"./DialogTitle-C3eBZids.js";import{L as P,A as q}from"./AdapterDayjs-BPhbSeWE.js";import{T as m}from"./TextField-BmVWmDzd.js";import{G as r}from"./Grid-BdmJn5bP.js";import{F as g,a as v,S as b}from"./Select-B1EkSlUY.js";import{A as y}from"./Autocomplete-BIV6h0T7.js";import{D as W}from"./DateTimePicker-jnzvj6J0.js";import{D as J}from"./DialogActions-h_2rRG3x.js";import{S as K}from"./Snackbar-BVA3LOhi.js";const C={title:"",meet_for:"Lead",lead_name:"",outgoing_call_status:"Scheduled",from:"",to:"",meeting_venue:"In Office",location:"",completed_meet_notes:""};function ce({open:u,onClose:h,selectedMeeting:o,initialData:f,onSuccess:S}){const[a,s]=l.useState(C),[p,j]=l.useState({open:!1,message:"",severity:"success"}),[D,A]=l.useState([]),[L,k]=l.useState([]),[I,z]=l.useState([]);l.useEffect(()=>{u&&(_("Lead",["name","lead_name","converted_contact","converted_account"]).then(A),_("Contacts",["name","first_name","last_name"]).then(k),_("Accounts",["name","account_name"]).then(z))},[u]),l.useEffect(()=>{var t;s(o?{title:o.title,meet_for:o.meet_for||"Lead",outgoing_call_status:o.outgoing_call_status||"Scheduled",from:o.from.replace(" ","T"),to:((t=o.to)==null?void 0:t.replace(" ","T"))||"",meeting_venue:o.meeting_venue||"In Office",location:o.location||"",completed_meet_notes:H(o.completed_meet_notes||""),lead_name:o.lead_name||"",contact_name:o.contact_name||"",account_name:o.account_name||""}:f?{...C,...f}:C)},[o,f,u]);const E=async()=>{var t,n;try{const d={...a,from:(t=a.from)==null?void 0:t.replace("T"," "),to:((n=a.to)==null?void 0:n.replace("T"," "))||void 0};o?await B(o.name,d):await N(d),h(),S&&S()}catch(d){console.error("Failed to save meeting:",d),j({open:!0,message:d.message||"Failed to save meeting",severity:"error"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(G,{open:u,onClose:h,fullWidth:!0,maxWidth:"sm",children:[e.jsxs(M,{sx:{m:0,p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c,{sx:{display:"flex",alignItems:"center",gap:1.5},children:e.jsx(x,{variant:"h6",sx:{fontWeight:700},children:o?"Edit Meeting":"New Meeting"})}),e.jsx(F,{onClick:h,sx:{color:"text.secondary"},children:e.jsx(Y,{icon:"mingcute:close-line"})})]}),e.jsx(R,{dividers:!0,sx:{borderBottom:"none",px:3,pb:0},children:e.jsx(P,{dateAdapter:q,children:e.jsxs(c,{sx:{py:2,display:"flex",flexDirection:"column",gap:4},children:[e.jsxs(c,{children:[e.jsx(x,{variant:"overline",sx:{color:"text.secondary",fontWeight:700,mb:2,display:"block"},children:"General Information"}),e.jsxs(c,{sx:{display:"flex",flexDirection:"column",gap:2.5},children:[e.jsx(m,{fullWidth:!0,label:"Title",placeholder:"Enter meeting title",value:a.title,onChange:t=>s({...a,title:t.target.value})}),e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{size:{xs:12,md:6},children:e.jsxs(g,{fullWidth:!0,children:[e.jsx(v,{children:"Meet For"}),e.jsxs(b,{label:"Meet For",value:a.meet_for,onChange:t=>s({...a,meet_for:t.target.value,lead_name:"",contact_name:"",account_name:""}),children:[e.jsx(i,{value:"Lead",children:"Lead"}),e.jsx(i,{value:"Contact",children:"Contact"}),e.jsx(i,{value:"Accounts",children:"Account"}),e.jsx(i,{value:"Others",children:"Others"})]})]})}),a.meet_for==="Lead"&&e.jsx(r,{size:{xs:12,md:6},children:e.jsx(y,{fullWidth:!0,options:D,getOptionLabel:t=>typeof t=="string"?t:`${t.lead_name} (${t.name})`,value:D.find(t=>t.name===a.lead_name)||null,onChange:(t,n)=>{s({...a,lead_name:(n==null?void 0:n.name)||"",contact_name:(n==null?void 0:n.converted_contact)||"",account_name:(n==null?void 0:n.converted_account)||""})},renderInput:t=>e.jsx(m,{...t,label:"Select Lead"})})}),a.meet_for==="Contact"&&e.jsx(r,{size:{xs:12,md:6},children:e.jsx(y,{fullWidth:!0,options:L,getOptionLabel:t=>typeof t=="string"?t:`${t.first_name||""} ${t.last_name||""} (${t.name})`.trim(),value:L.find(t=>t.name===a.contact_name)||null,onChange:(t,n)=>s({...a,contact_name:(n==null?void 0:n.name)||""}),renderInput:t=>e.jsx(m,{...t,label:"Select Contact"})})}),a.meet_for==="Accounts"&&e.jsx(r,{size:{xs:12,md:6},children:e.jsx(y,{fullWidth:!0,options:I,getOptionLabel:t=>typeof t=="string"?t:`${t.account_name} (${t.name})`,value:I.find(t=>t.name===a.account_name)||null,onChange:(t,n)=>s({...a,account_name:(n==null?void 0:n.name)||""}),renderInput:t=>e.jsx(m,{...t,label:"Select Account"})})}),e.jsx(r,{size:{xs:12},children:e.jsxs(g,{fullWidth:!0,children:[e.jsx(v,{children:"Status"}),e.jsxs(b,{label:"Status",value:a.outgoing_call_status,onChange:t=>s({...a,outgoing_call_status:t.target.value}),children:[e.jsx(i,{value:"Scheduled",children:"Scheduled"}),e.jsx(i,{value:"Completed",children:"Completed"})]})]})})]})]})]}),e.jsxs(c,{children:[e.jsx(x,{variant:"overline",sx:{color:"text.secondary",fontWeight:700,mb:2,display:"block"},children:"Time Schedule"}),e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{size:{xs:12,md:6},children:e.jsx(W,{label:"From",value:a.from?T(a.from):null,onChange:t=>s({...a,from:t?t.format("YYYY-MM-DD HH:mm:ss"):""})})}),e.jsx(r,{size:{xs:12,md:6},children:e.jsx(W,{label:"To",value:a.to?T(a.to):null,onChange:t=>s({...a,to:t?t.format("YYYY-MM-DD HH:mm:ss"):""})})})]})]}),e.jsxs(c,{children:[e.jsx(x,{variant:"overline",sx:{color:"text.secondary",fontWeight:700,mb:2,display:"block"},children:"Location & Venue"}),e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{size:{xs:12,md:6},children:e.jsxs(g,{fullWidth:!0,children:[e.jsx(v,{children:"Venue"}),e.jsxs(b,{label:"Venue",value:a.meeting_venue,onChange:t=>s({...a,meeting_venue:t.target.value}),children:[e.jsx(i,{value:"In Office",children:"In Office"}),e.jsx(i,{value:"Client Location",children:"Client Location"}),e.jsx(i,{value:"Online",children:"Online"})]})]})}),e.jsx(r,{size:{xs:12,md:6},children:e.jsx(m,{fullWidth:!0,label:"Location",placeholder:"Enter address or link",value:a.location,onChange:t=>s({...a,location:t.target.value})})})]})]}),e.jsxs(c,{children:[e.jsx(x,{variant:"overline",sx:{color:"text.secondary",fontWeight:700,mb:2,display:"block"},children:"Meeting Notes"}),e.jsx(m,{fullWidth:!0,multiline:!0,rows:4,label:"Notes",placeholder:"Write summary or observations...",value:a.completed_meet_notes,onChange:t=>s({...a,completed_meet_notes:t.target.value})})]})]})})}),e.jsxs(J,{sx:{p:3,pt:2,gap:1.5},children:[e.jsx(O,{color:"inherit",variant:"outlined",onClick:h,sx:{borderRadius:1},children:"Cancel"}),e.jsx(O,{variant:"contained",color:"info",onClick:E,sx:{borderRadius:1,px:3},children:o?"Save Changes":"Create Meeting"})]})]}),e.jsx(K,{open:p.open,autoHideDuration:6e3,onClose:()=>j(t=>({...t,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx($,{onClose:()=>j(t=>({...t,open:!1})),severity:p.severity,sx:{width:"100%"},children:p.message})})]})}export{ce as M};
